<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>林伟源的技术博客</title>
  
  
  <link href="https://linweiyuan.github.io/atom.xml" rel="self"/>
  
  <link href="https://linweiyuan.github.io/"/>
  <updated>2022-09-23T18:38:44.657Z</updated>
  <id>https://linweiyuan.github.io/</id>
  
  <author>
    <name>林伟源</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Ingress配置pgAdmin需要注意的问题</title>
    <link href="https://linweiyuan.github.io/2022/09/23/Ingress%E9%85%8D%E7%BD%AEpgAdmin%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E9%97%AE%E9%A2%98.html"/>
    <id>https://linweiyuan.github.io/2022/09/23/Ingress%E9%85%8D%E7%BD%AEpgAdmin%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E9%97%AE%E9%A2%98.html</id>
    <published>2022-09-23T17:32:34.000Z</published>
    <updated>2022-09-23T18:38:44.657Z</updated>
    
    <content type="html"><![CDATA[<p>当使用 Docker 或者 Docker Compose 部署 pgAdmin 来方便本地开发访问使用的时候，是不需要额外注意的，因为通常都是直接暴露端口出去</p><p>但是基于 K8s 环境下部署的时候，需要稍微注意一点地方</p><h1 id="K8s-集群准备"><a href="#K8s-集群准备" class="headerlink" title="K8s 集群准备"></a>K8s 集群准备</h1><p>K8s 的搭建方式多种多样，比如 k3d、kubeadm、kind 等，由于多年之前有裸装 Oracle 把系统搞烂的经历，对于一些软件的安装，我这边是比较谨慎的。况且后面接触了容器，能在里面跑就里面跑，什么两倍读写的问题不考虑，所以我使用的是 <code>kind</code> 来搭建集群</p><p>为了服务在容器外能访问，kind 创建 K8s 集群的时候还需要一些额外的配置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">kind:</span> <span class="string">Cluster</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">kind.x-k8s.io/v1alpha4</span></span><br><span class="line"><span class="attr">networking:</span></span><br><span class="line">  <span class="attr">apiServerAddress:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">  <span class="attr">apiServerPort:</span> <span class="number">6443</span></span><br><span class="line"><span class="attr">nodes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">control-plane</span></span><br><span class="line">    <span class="attr">kubeadmConfigPatches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">|</span></span><br><span class="line"><span class="string">        kind: InitConfiguration</span></span><br><span class="line"><span class="string">        nodeRegistration:</span></span><br><span class="line"><span class="string">          kubeletExtraArgs:</span></span><br><span class="line"><span class="string">            node-labels: &quot;ingress-ready=true&quot;</span></span><br><span class="line"><span class="string"></span>    <span class="attr">extraPortMappings:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">        <span class="attr">hostPort:</span> <span class="number">80</span></span><br><span class="line">        <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">443</span></span><br><span class="line">        <span class="attr">hostPort:</span> <span class="number">443</span></span><br><span class="line">        <span class="attr">protocol:</span> <span class="string">TCP</span></span><br></pre></td></tr></table></figure><h1 id="Ingress-Controller-准备"><a href="#Ingress-Controller-准备" class="headerlink" title="Ingress Controller 准备"></a>Ingress Controller 准备</h1><p>K8s 暴露服务的方式也多种多样，比如 NodePort、LoadBalancer、Ingress。由于 kind 的特殊性，整个 K8s 集群都跑在容器中，所以就算 NodePort 也是容器里的端口，所以这次主要讨论 Ingress，使用的是 <code>Nginx</code></p><p>使用 Ingress，首先需要在集群中安装一个 Ingress Controller，然后通过 Ingress 来进行一些配置，当 apply 的时候，Ingress Controller 会自动更新 nginx.conf 并进行 reload</p><p>如果之前配置过 Nginx，其实类比起来是很像的，一个 Ingress Controller 相当于一个 Nginx，一个 Ingress 则好比 Nginx 的配置文件</p><p>当 Ingress Controller 准备好后，会以 NodePort 的方式暴露 80 和 443 端口</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NAME                                 TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)                      AGE</span><br><span class="line">ingress-nginx-controller             NodePort    10.96.30.54    &lt;none&gt;        80:30860/TCP，443:31875/TCP   3d</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="pgAdmin-准备"><a href="#pgAdmin-准备" class="headerlink" title="pgAdmin 准备"></a>pgAdmin 准备</h1><p>为了简单起见，使用 <code>helm</code> 来安装 pgAdmin</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">helm install pgadmin runix/pgadmin4 --<span class="built_in">set</span> env.email=root@linweiyuan.com --<span class="built_in">set</span> env.password=toor</span><br></pre></td></tr></table></figure><h1 id="Ingress-准备"><a href="#Ingress-准备" class="headerlink" title="Ingress 准备"></a>Ingress 准备</h1><p>配置好 Ingress 规则，因为想做到访问不同的 path 路由到不同的服务，所以这里用 &#x2F;pgAdmin 来设置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pgadmin-ingress</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">http:</span></span><br><span class="line">        <span class="attr">paths:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">&quot;/pgAdmin&quot;</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">pgadmin-pgadmin4</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><p>但是此时访问 <a href="http://localhost/pgAdmin">http://localhost/pgAdmin</a> 的时候，会返回 404</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Not Found The requested URL was not found on the server. If you entered the URL</span><br><span class="line">manually please check your spelling and try again.</span><br></pre></td></tr></table></figure><h1 id="pgAdmin-访问解决"><a href="#pgAdmin-访问解决" class="headerlink" title="pgAdmin 访问解决"></a>pgAdmin 访问解决</h1><p>查看<a href="https://www.pgadmin.org/docs/pgadmin4/latest/container_deployment.html#http-via-nginx">官方文档</a>，会发现这么一句话</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">If you wish to host pgAdmin under a subdirectory rather than on the root of the server, you must specify the location and set the X-Script-Name header which tells the pgAdmin container how to rewrite paths</span><br></pre></td></tr></table></figure><p>就是说 Nginx 的配置里要加 <code>X-Script-Name</code>，但是在 K8s 里要怎么加？</p><p>前面提过，其实无非是修改 Ingress 的配置，此时如果进入 Ingress Controller 的 pod 中查看配置文件，会发现当前配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bash-5.1$ hostname</span><br><span class="line">ingress-nginx-controller-65b4b4df7d-rhd2k</span><br><span class="line">bash-5.1$ <span class="built_in">cat</span> -n nginx.conf | grep pgAdmin</span><br><span class="line">   297location /pgAdmin/ &#123;</span><br><span class="line">   303<span class="built_in">set</span> <span class="variable">$location_path</span>  <span class="string">&quot;/pgAdmin&quot;</span>;</span><br><span class="line">   415location = /pgAdmin &#123;</span><br><span class="line">   421<span class="built_in">set</span> <span class="variable">$location_path</span>  <span class="string">&quot;/pgAdmin&quot;</span>;</span><br></pre></td></tr></table></figure><p>而根据 pgAdmin 官方文档的指引，需要把配置加到 location 下，回头查看 <a href="https://github.com/kubernetes/ingress-nginx/blob/main/docs/user-guide/nginx-configuration/annotations.md#configuration-snippet">K8s 官方文档</a>，发现其实是配置 <code>nginx.ingress.kubernetes.io/configuration-snippet</code></p><p>因此配置文件进行修改，完整配置文件如下</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pgadmin-ingress</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">nginx.ingress.kubernetes.io/configuration-snippet:</span> <span class="string">|</span></span><br><span class="line"><span class="string">      proxy_set_header X-Script-Name /pgAdmin;</span></span><br><span class="line"><span class="string"></span><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">http:</span></span><br><span class="line">        <span class="attr">paths:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">&quot;/pgAdmin&quot;</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">pgadmin-pgadmin4</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><p>再 apply</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kaf pgadmin-ingress.yaml</span><br><span class="line">ingress.networking.k8s.io/pgadmin-ingress configured</span><br></pre></td></tr></table></figure><p>再查看 nginx.conf，已经生效了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bash-5.1$ <span class="built_in">cat</span> -n nginx.conf | grep pgAdmin</span><br><span class="line">   297location /pgAdmin/ &#123;</span><br><span class="line">   303<span class="built_in">set</span> <span class="variable">$location_path</span>  <span class="string">&quot;/pgAdmin&quot;</span>;</span><br><span class="line">   409proxy_set_header X-Script-Name /pgAdmin;</span><br><span class="line">   417location = /pgAdmin &#123;</span><br><span class="line">   423<span class="built_in">set</span> <span class="variable">$location_path</span>  <span class="string">&quot;/pgAdmin&quot;</span>;</span><br><span class="line">   529proxy_set_header X-Script-Name /pgAdmin;</span><br></pre></td></tr></table></figure><p>此时再访问 <a href="http://localhost/pgAdmin">http://localhost/pgAdmin</a></p><p>会自动跳转 <a href="http://localhost/pgAdmin/login?next=/pgAdmin/">http://localhost/pgAdmin/login?next=%2FpgAdmin%2F</a></p><p>用上面 helm 设置的用户名和密码即可登录进去，问题解决</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;当使用 Docker 或者 Docker Compose 部署 pgAdmin 来方便本地开发访问使用的时候，是不需要额外注意的，因为通常都是直接暴露端口出去&lt;/p&gt;
&lt;p&gt;但是基于 K8s 环境下部署的时候，需要稍微注意一点地方&lt;/p&gt;
&lt;h1 id=&quot;K8s-集群准备&quot;</summary>
      
    
    
    
    <category term="容器技术" scheme="https://linweiyuan.github.io/categories/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/"/>
    
    <category term="Kubernetes" scheme="https://linweiyuan.github.io/categories/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/Kubernetes/"/>
    
    
    <category term="Kubernetes" scheme="https://linweiyuan.github.io/tags/Kubernetes/"/>
    
    <category term="pgAdmin" scheme="https://linweiyuan.github.io/tags/pgAdmin/"/>
    
    <category term="Ingress" scheme="https://linweiyuan.github.io/tags/Ingress/"/>
    
  </entry>
  
  <entry>
    <title>Docker 常用服务</title>
    <link href="https://linweiyuan.github.io/2022/07/26/Docker-%E5%B8%B8%E7%94%A8%E6%9C%8D%E5%8A%A1.html"/>
    <id>https://linweiyuan.github.io/2022/07/26/Docker-%E5%B8%B8%E7%94%A8%E6%9C%8D%E5%8A%A1.html</id>
    <published>2022-07-26T18:42:48.000Z</published>
    <updated>2022-09-23T18:38:44.657Z</updated>
    
    <content type="html"><![CDATA[<p>整理了下常用的 <code>Docker</code> 服务： <a href="https://github.com/linweiyuan/docker-services">https://github.com/linweiyuan/docker-services</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;整理了下常用的 &lt;code&gt;Docker&lt;/code&gt; 服务： &lt;a href=&quot;https://github.com/linweiyuan/docker-services&quot;&gt;https://github.com/linweiyuan/docker-services&lt;/a&gt;</summary>
      
    
    
    
    <category term="容器技术" scheme="https://linweiyuan.github.io/categories/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="Docker" scheme="https://linweiyuan.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Docker 使用国内镜像源时遇到的坑</title>
    <link href="https://linweiyuan.github.io/2022/07/25/Docker-%E4%BD%BF%E7%94%A8%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F%E6%BA%90%E6%97%B6%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91.html"/>
    <id>https://linweiyuan.github.io/2022/07/25/Docker-%E4%BD%BF%E7%94%A8%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F%E6%BA%90%E6%97%B6%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91.html</id>
    <published>2022-07-25T02:50:47.000Z</published>
    <updated>2022-09-23T18:38:44.657Z</updated>
    
    <content type="html"><![CDATA[<p>详见：<a href="https://github.com/ustclug/discussions/issues/396">https://github.com/ustclug/discussions/issues/396</a></p><p>“故从 2020 年 4 月起，从科大校外对 Docker Hub 镜像缓存的访问会被 302 重定向至其他国内 Docker Hub 镜像源”</p><p>可以看到是重定向到阿里云</p><p><a href="https://docker.mirrors.ustc.edu.cn/">https://docker.mirrors.ustc.edu.cn</a> -&gt; <a href="https://ustc-edu-cn.mirror.aliyuncs.com/">https://ustc-edu-cn.mirror.aliyuncs.com</a></p><p>但是校外访问这个仓库已经是旧的了</p><p>替代品</p><ul><li>直连</li><li>阿里云（广州或杭州，或自己账号）：<a href="https://registry.cn-guangzhou.aliyuncs.com/">https://registry.cn-guangzhou.aliyuncs.com</a></li><li>网易（容易连着连着自动断开）：<a href="https://hub-mirror.c.163.com/">https://hub-mirror.c.163.com</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;详见：&lt;a href=&quot;https://github.com/ustclug/discussions/issues/396&quot;&gt;https://github.com/ustclug/discussions/issues/396&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;“故从 2020 年 4 </summary>
      
    
    
    
    <category term="容器技术" scheme="https://linweiyuan.github.io/categories/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="Docker" scheme="https://linweiyuan.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Kotlin动态代理</title>
    <link href="https://linweiyuan.github.io/2020/08/27/Kotlin%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86.html"/>
    <id>https://linweiyuan.github.io/2020/08/27/Kotlin%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86.html</id>
    <published>2020-08-27T19:59:12.000Z</published>
    <updated>2022-09-23T18:38:44.661Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">method!!.invoke(obj, *(args ?: emptyArray()))</span><br></pre></td></tr></table></figure><hr><p>相比之下<code>Java</code>的方式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">method.invoke(obj, args);</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight kotlin&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span cl</summary>
      
    
    
    
    <category term="程序设计" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    
    
    <category term="Kotlin" scheme="https://linweiyuan.github.io/tags/Kotlin/"/>
    
  </entry>
  
  <entry>
    <title>微信开发的坑</title>
    <link href="https://linweiyuan.github.io/2020/04/27/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91%E7%9A%84%E5%9D%91.html"/>
    <id>https://linweiyuan.github.io/2020/04/27/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91%E7%9A%84%E5%9D%91.html</id>
    <published>2020-04-27T08:12:13.000Z</published>
    <updated>2022-09-23T18:38:44.661Z</updated>
    
    <content type="html"><![CDATA[<ul><li><p>参数<br>部分<code>xml</code>, 部分<code>json</code></p></li><li><p>接口校验<br>首次校验接口<code>SHA-1</code>参数值字典序, 其他接口<code>MD5</code>参数值<code>key</code>, <code>value</code>字典序</p></li><li><p>微信支付<br><a href="https://pay.weixin.qq.com/wiki/doc/api/tools/mch_pay.php?chapter=14_2">企业付款</a>: 参数<code>mch_appid</code>, <code>mchid</code>, 旁边<code>签名算法</code>链接的示例整个<code>appid</code>, <code>mch_id</code><br><a href="https://pay.weixin.qq.com/wiki/doc/api/tools/mch_pay.php?chapter=23_1&index=2">支付验收指引</a> 就是<code>sandbox</code></p><ul><li>参数又变成<code>mch_id</code></li><li>不能输入随意金额</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;参数&lt;br&gt;部分&lt;code&gt;xml&lt;/code&gt;, 部分&lt;code&gt;json&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;接口校验&lt;br&gt;首次校验接口&lt;code&gt;SHA-1&lt;/code&gt;参数值字典序, 其他接口&lt;code&gt;MD5&lt;/code&gt;参数值&lt;c</summary>
      
    
    
    
    <category term="程序设计" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    
    
    <category term="Kotlin" scheme="https://linweiyuan.github.io/tags/Kotlin/"/>
    
    <category term="WeChatPay" scheme="https://linweiyuan.github.io/tags/WeChatPay/"/>
    
  </entry>
  
  <entry>
    <title>某站程序和文件上传漏洞</title>
    <link href="https://linweiyuan.github.io/2020/01/25/%E6%9F%90%E7%AB%99%E7%A8%8B%E5%BA%8F%E5%92%8C%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.html"/>
    <id>https://linweiyuan.github.io/2020/01/25/%E6%9F%90%E7%AB%99%E7%A8%8B%E5%BA%8F%E5%92%8C%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.html</id>
    <published>2020-01-25T06:44:43.000Z</published>
    <updated>2022-09-23T18:38:44.665Z</updated>
    
    <content type="html"><![CDATA[<h3 id="利用程序漏洞成功以-admin-身份登录后台-数据泄露"><a href="#利用程序漏洞成功以-admin-身份登录后台-数据泄露" class="headerlink" title="利用程序漏洞成功以 admin 身份登录后台, 数据泄露"></a>利用程序漏洞成功以 admin 身份登录后台, 数据泄露</h3><p><img src="/2020/01/25/%E6%9F%90%E7%AB%99%E7%A8%8B%E5%BA%8F%E5%92%8C%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/admin.png"></p><h3 id="任意文件类型上传-jspx-小-shell"><a href="#任意文件类型上传-jspx-小-shell" class="headerlink" title="任意文件类型上传, jspx 小 shell"></a>任意文件类型上传, jspx 小 shell</h3><p><img src="/2020/01/25/%E6%9F%90%E7%AB%99%E7%A8%8B%E5%BA%8F%E5%92%8C%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/jspx.png"></p><h3 id="Windows-操作系统"><a href="#Windows-操作系统" class="headerlink" title="Windows 操作系统"></a>Windows 操作系统</h3><p><img src="/2020/01/25/%E6%9F%90%E7%AB%99%E7%A8%8B%E5%BA%8F%E5%92%8C%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/windows.png"></p><h3 id="数据库配置泄露"><a href="#数据库配置泄露" class="headerlink" title="数据库配置泄露"></a>数据库配置泄露</h3><p><img src="/2020/01/25/%E6%9F%90%E7%AB%99%E7%A8%8B%E5%BA%8F%E5%92%8C%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/db.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;利用程序漏洞成功以-admin-身份登录后台-数据泄露&quot;&gt;&lt;a href=&quot;#利用程序漏洞成功以-admin-身份登录后台-数据泄露&quot; class=&quot;headerlink&quot; title=&quot;利用程序漏洞成功以 admin 身份登录后台, 数据泄露&quot;&gt;&lt;/a&gt;利用程序</summary>
      
    
    
    
    <category term="网络安全" scheme="https://linweiyuan.github.io/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="Windows" scheme="https://linweiyuan.github.io/tags/Windows/"/>
    
    <category term="Vulnerability" scheme="https://linweiyuan.github.io/tags/Vulnerability/"/>
    
    <category term="JSPX" scheme="https://linweiyuan.github.io/tags/JSPX/"/>
    
  </entry>
  
  <entry>
    <title>Anko放弃维护</title>
    <link href="https://linweiyuan.github.io/2019/12/02/Anko%E6%94%BE%E5%BC%83%E7%BB%B4%E6%8A%A4.html"/>
    <id>https://linweiyuan.github.io/2019/12/02/Anko%E6%94%BE%E5%BC%83%E7%BB%B4%E6%8A%A4.html</id>
    <published>2019-12-02T13:13:54.000Z</published>
    <updated>2022-09-23T18:38:44.657Z</updated>
    
    <content type="html"><![CDATA[<p>用<code>Anko</code>写过一个<code>Android</code>应用 -&gt; <a href="https://github.com/linweiyuan/MHP">怪物猎人金手指 for Android</a>, 最喜欢的就是<code>doAsync</code>和<code>uiThread</code>, 今天升级下依赖, 发现提示<code>Anko is deprecated</code>, 并且给出了一个说明 -&gt; <a href="https://github.com/Kotlin/anko/blob/master/GOODBYE.md">Discontinuing Anko</a></p><p>截止目前<code>15.4k</code>的<code>Star</code>, 这个项目确实很好, 真是令人惋惜</p><p>希望<code>Ktor</code>能持续发展</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;用&lt;code&gt;Anko&lt;/code&gt;写过一个&lt;code&gt;Android&lt;/code&gt;应用 -&amp;gt; &lt;a href=&quot;https://github.com/linweiyuan/MHP&quot;&gt;怪物猎人金手指 for Android&lt;/a&gt;, 最喜欢的就是&lt;code&gt;doAsy</summary>
      
    
    
    
    <category term="程序设计" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    
    
    <category term="Kotlin" scheme="https://linweiyuan.github.io/tags/Kotlin/"/>
    
    <category term="Anko" scheme="https://linweiyuan.github.io/tags/Anko/"/>
    
  </entry>
  
  <entry>
    <title>某站XSS漏洞</title>
    <link href="https://linweiyuan.github.io/2019/11/11/%E6%9F%90%E7%AB%99XSS%E6%BC%8F%E6%B4%9E.html"/>
    <id>https://linweiyuan.github.io/2019/11/11/%E6%9F%90%E7%AB%99XSS%E6%BC%8F%E6%B4%9E.html</id>
    <published>2019-11-11T07:28:35.000Z</published>
    <updated>2022-09-23T18:38:44.665Z</updated>
    
    <content type="html"><![CDATA[<h3 id="插入任意-JS-脚本"><a href="#插入任意-JS-脚本" class="headerlink" title="插入任意 JS 脚本"></a>插入任意 JS 脚本</h3><p><img src="/2019/11/11/%E6%9F%90%E7%AB%99XSS%E6%BC%8F%E6%B4%9E/image.png"></p><h3 id="JS-脚本加载"><a href="#JS-脚本加载" class="headerlink" title="JS 脚本加载"></a>JS 脚本加载</h3><p><img src="/2019/11/11/%E6%9F%90%E7%AB%99XSS%E6%BC%8F%E6%B4%9E/js.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;插入任意-JS-脚本&quot;&gt;&lt;a href=&quot;#插入任意-JS-脚本&quot; class=&quot;headerlink&quot; title=&quot;插入任意 JS 脚本&quot;&gt;&lt;/a&gt;插入任意 JS 脚本&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/2019/11/11/%E6%9F%90%E7%AB%</summary>
      
    
    
    
    <category term="网络安全" scheme="https://linweiyuan.github.io/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="Vulnerability" scheme="https://linweiyuan.github.io/tags/Vulnerability/"/>
    
    <category term="XSS" scheme="https://linweiyuan.github.io/tags/XSS/"/>
    
    <category term="JSPX" scheme="https://linweiyuan.github.io/tags/JSPX/"/>
    
  </entry>
  
  <entry>
    <title>PyPI加速</title>
    <link href="https://linweiyuan.github.io/2019/10/06/PyPI%E5%8A%A0%E9%80%9F.html"/>
    <id>https://linweiyuan.github.io/2019/10/06/PyPI%E5%8A%A0%E9%80%9F.html</id>
    <published>2019-10-06T01:47:06.000Z</published>
    <updated>2022-09-23T18:38:44.661Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">index-url = https://mirrors.tuna.tsinghua.edu.cn/pypi/simple</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;</summary>
      
    
    
    
    <category term="程序设计" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    
    
    <category term="Python" scheme="https://linweiyuan.github.io/tags/Python/"/>
    
    <category term="pip" scheme="https://linweiyuan.github.io/tags/pip/"/>
    
  </entry>
  
  <entry>
    <title>VirtualBox压缩虚拟硬盘</title>
    <link href="https://linweiyuan.github.io/2019/08/06/VirtualBox%E5%8E%8B%E7%BC%A9%E8%99%9A%E6%8B%9F%E7%A1%AC%E7%9B%98.html"/>
    <id>https://linweiyuan.github.io/2019/08/06/VirtualBox%E5%8E%8B%E7%BC%A9%E8%99%9A%E6%8B%9F%E7%A1%AC%E7%9B%98.html</id>
    <published>2019-08-06T14:16:22.000Z</published>
    <updated>2022-09-23T18:38:44.661Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo dd if=/dev/zero of=/empty bs=1M</span><br><span class="line">sudo rm -f /empty</span><br></pre></td></tr></table></figure><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>下载 -&gt; <a href="http://technet.microsoft.com/en-us/sysinternals/bb842062.aspx">Sysinternals Suite</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sdelete –z C:</span><br></pre></td></tr></table></figure><p>关机执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vboxmanage modifyhd xxx.vdi --compact</span><br></pre></td></tr></table></figure><p>提示</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;Linux&quot;&gt;&lt;a href=&quot;#Linux&quot; class=&quot;headerlink&quot; title=&quot;Linux&quot;&gt;&lt;/a&gt;Linux&lt;/h3&gt;&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gut</summary>
      
    
    
    
    <category term="虚拟机" scheme="https://linweiyuan.github.io/categories/%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
    
    <category term="VirtualBox" scheme="https://linweiyuan.github.io/tags/VirtualBox/"/>
    
  </entry>
  
  <entry>
    <title>Android License</title>
    <link href="https://linweiyuan.github.io/2019/07/26/Android-License.html"/>
    <id>https://linweiyuan.github.io/2019/07/26/Android-License.html</id>
    <published>2019-07-26T14:39:22.000Z</published>
    <updated>2022-09-23T18:38:44.657Z</updated>
    
    <content type="html"><![CDATA[<p>Android 开发中提示<code>License for package xxx not accepted.</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">yes</span> | sdkmanager --licenses</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Android 开发中提示&lt;code&gt;License for package xxx not accepted.&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;sp</summary>
      
    
    
    
    <category term="程序设计" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    
    
    <category term="Android" scheme="https://linweiyuan.github.io/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>减少MySQL内存占用</title>
    <link href="https://linweiyuan.github.io/2019/07/21/%E5%87%8F%E5%B0%91MySQL%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8.html"/>
    <id>https://linweiyuan.github.io/2019/07/21/%E5%87%8F%E5%B0%91MySQL%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8.html</id>
    <published>2019-07-21T10:07:49.000Z</published>
    <updated>2022-09-23T18:38:44.661Z</updated>
    
    <content type="html"><![CDATA[<p>MySQL 高版本默认开启<code>performance_schema</code> -&gt; <a href="https://dev.mysql.com/doc/refman/5.7/en/performance-schema-startup-configuration.html">Performance Schema Startup Configuration</a></p><p>用 Docker 启动一个 MySQL 容器, 开启的情况下启动完成占用内存接近 400M</p><p>关闭配置</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="attr">performance_schema</span>=<span class="literal">OFF</span></span><br></pre></td></tr></table></figure><p>重启 MySQL 占用内存 100M 左右</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;MySQL 高版本默认开启&lt;code&gt;performance_schema&lt;/code&gt; -&amp;gt; &lt;a href=&quot;https://dev.mysql.com/doc/refman/5.7/en/performance-schema-startup-configurat</summary>
      
    
    
    
    <category term="数据库" scheme="https://linweiyuan.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="MySQL" scheme="https://linweiyuan.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>i3status显示网速</title>
    <link href="https://linweiyuan.github.io/2019/07/20/i3status%E6%98%BE%E7%A4%BA%E7%BD%91%E9%80%9F.html"/>
    <id>https://linweiyuan.github.io/2019/07/20/i3status%E6%98%BE%E7%A4%BA%E7%BD%91%E9%80%9F.html</id>
    <published>2019-07-20T05:23:24.000Z</published>
    <updated>2022-09-23T18:38:44.661Z</updated>
    
    <content type="html"><![CDATA[<p>下载脚本 -&gt; <a href="http://code.stapelberg.de/git/i3status/plain/contrib/net-speed.sh">net-speed.sh</a>, 修改<code>bar</code>执行程序路径指向脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bar &#123;</span><br><span class="line">    status_command <span class="built_in">exec</span> net-speed.sh</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改成好看的格式</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;rate&#125;</span>| <span class="variable">$&#123;line&#125;</span>&quot;</span> || <span class="built_in">exit</span> 1</span><br></pre></td></tr></table></figure><p>重新加载 i3 配置文件</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;下载脚本 -&amp;gt; &lt;a href=&quot;http://code.stapelberg.de/git/i3status/plain/contrib/net-speed.sh&quot;&gt;net-speed.sh&lt;/a&gt;, 修改&lt;code&gt;bar&lt;/code&gt;执行程序路径指向脚本&lt;/p&gt;</summary>
      
    
    
    
    <category term="操作系统" scheme="https://linweiyuan.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
    <category term="Arch Linux" scheme="https://linweiyuan.github.io/tags/Arch-Linux/"/>
    
    <category term="i3" scheme="https://linweiyuan.github.io/tags/i3/"/>
    
    <category term="i3status" scheme="https://linweiyuan.github.io/tags/i3status/"/>
    
  </entry>
  
  <entry>
    <title>Linux和Windows共享硬盘挂载问题解决方案</title>
    <link href="https://linweiyuan.github.io/2019/07/02/Linux%E5%92%8CWindows%E5%85%B1%E4%BA%AB%E7%A1%AC%E7%9B%98%E6%8C%82%E8%BD%BD%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.html"/>
    <id>https://linweiyuan.github.io/2019/07/02/Linux%E5%92%8CWindows%E5%85%B1%E4%BA%AB%E7%A1%AC%E7%9B%98%E6%8C%82%E8%BD%BD%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.html</id>
    <published>2019-07-02T12:25:01.000Z</published>
    <updated>2022-09-23T18:38:44.661Z</updated>
    
    <content type="html"><![CDATA[<p>双系统 Linux + Windows 10, Windows 下有 NTFS 格式 1T 硬盘(比如 D 盘), Linux 下按需挂载时出现问题</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mount /dev/sdb1 Temp</span><br></pre></td></tr></table></figure><p>报错</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">The disk contains an unclean file system (0, 0).</span><br><span class="line">Metadata kept <span class="keyword">in</span> Windows cache, refused to mount.</span><br><span class="line">Falling back to read-only mount because the NTFS partition is <span class="keyword">in</span> an</span><br><span class="line">unsafe state. Please resume and shutdown Windows fully (no hibernation</span><br><span class="line">or fast restarting.)</span><br></pre></td></tr></table></figure><p>利用<code>ntfsfix</code>命令解决</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ntfsfix /dev/sdb1</span><br></pre></td></tr></table></figure><p>修复<code>脏</code>数据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Mounting volume... The disk contains an unclean file system (0, 0).</span><br><span class="line">Metadata kept <span class="keyword">in</span> Windows cache, refused to mount.</span><br><span class="line">FAILED</span><br><span class="line">Attempting to correct errors...</span><br><span class="line">Processing <span class="variable">$MFT</span> and <span class="variable">$MFTMirr</span>...</span><br><span class="line">Reading <span class="variable">$MFT</span>... OK</span><br><span class="line">Reading <span class="variable">$MFTMirr</span>... OK</span><br><span class="line">Comparing <span class="variable">$MFTMirr</span> to <span class="variable">$MFT</span>... OK</span><br><span class="line">Processing of <span class="variable">$MFT</span> and <span class="variable">$MFTMirr</span> completed successfully.</span><br><span class="line">Setting required flags on partition... OK</span><br><span class="line">Going to empty the journal (<span class="variable">$LogFile</span>)... OK</span><br><span class="line">Checking the alternate boot sector... OK</span><br><span class="line">NTFS volume version is 3.1.</span><br><span class="line">NTFS partition /dev/sdb1 was processed successfully.</span><br></pre></td></tr></table></figure><p>以读写方式重新加载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mount -o rw /dev/sdb1</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;双系统 Linux + Windows 10, Windows 下有 NTFS 格式 1T 硬盘(比如 D 盘), Linux 下按需挂载时出现问题&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutte</summary>
      
    
    
    
    <category term="操作系统" scheme="https://linweiyuan.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
    <category term="Linux" scheme="https://linweiyuan.github.io/tags/Linux/"/>
    
    <category term="NTFS" scheme="https://linweiyuan.github.io/tags/NTFS/"/>
    
    <category term="Windows" scheme="https://linweiyuan.github.io/tags/Windows/"/>
    
  </entry>
  
  <entry>
    <title>某站越权漏洞</title>
    <link href="https://linweiyuan.github.io/2019/06/07/%E6%9F%90%E7%AB%99%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E.html"/>
    <id>https://linweiyuan.github.io/2019/06/07/%E6%9F%90%E7%AB%99%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E.html</id>
    <published>2019-06-07T06:34:55.000Z</published>
    <updated>2022-09-23T18:38:44.669Z</updated>
    
    <content type="html"><![CDATA[<h3 id="普通用户登录"><a href="#普通用户登录" class="headerlink" title="普通用户登录"></a>普通用户登录</h3><p><img src="/2019/06/07/%E6%9F%90%E7%AB%99%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E/normal.png"></p><h3 id="利用普通用户身份重置-admin-密码"><a href="#利用普通用户身份重置-admin-密码" class="headerlink" title="利用普通用户身份重置 admin 密码"></a>利用普通用户身份重置 admin 密码</h3><p><img src="/2019/06/07/%E6%9F%90%E7%AB%99%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E/reset_password.png"></p><h3 id="admin-登录"><a href="#admin-登录" class="headerlink" title="admin 登录"></a>admin 登录</h3><p><img src="/2019/06/07/%E6%9F%90%E7%AB%99%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E/admin.png"></p><h3 id="数据泄露"><a href="#数据泄露" class="headerlink" title="数据泄露"></a>数据泄露</h3><p><img src="/2019/06/07/%E6%9F%90%E7%AB%99%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E/data.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;普通用户登录&quot;&gt;&lt;a href=&quot;#普通用户登录&quot; class=&quot;headerlink&quot; title=&quot;普通用户登录&quot;&gt;&lt;/a&gt;普通用户登录&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/2019/06/07/%E6%9F%90%E7%AB%99%E8%B6%8A%E6%9</summary>
      
    
    
    
    <category term="网络安全" scheme="https://linweiyuan.github.io/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="Vulnerability" scheme="https://linweiyuan.github.io/tags/Vulnerability/"/>
    
    <category term="Unauthorized" scheme="https://linweiyuan.github.io/tags/Unauthorized/"/>
    
  </entry>
  
  <entry>
    <title>Javassist动态增强类</title>
    <link href="https://linweiyuan.github.io/2019/06/05/Javassist%E5%8A%A8%E6%80%81%E5%A2%9E%E5%BC%BA%E7%B1%BB.html"/>
    <id>https://linweiyuan.github.io/2019/06/05/Javassist%E5%8A%A8%E6%80%81%E5%A2%9E%E5%BC%BA%E7%B1%BB.html</id>
    <published>2019-06-05T16:07:35.000Z</published>
    <updated>2022-09-23T18:38:44.657Z</updated>
    
    <content type="html"><![CDATA[<p><code>User</code>类，只有一个字段<code>username</code>，在不继承或者其他方式前提下利用<code>Javassist</code>实现类增强</p><p><img src="/2019/06/05/Javassist%E5%8A%A8%E6%80%81%E5%A2%9E%E5%BC%BA%E7%B1%BB/javassist.png"></p><p>可以看到<code>.class</code>文件已被修改</p><p>重新加载字节码后发现<code>password</code>设为<code>private</code>没输出，<code>username</code>值被修改，<code>flag</code>设为<code>public</code>被输出，<code>getter</code>也被输出</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;User&lt;/code&gt;类，只有一个字段&lt;code&gt;username&lt;/code&gt;，在不继承或者其他方式前提下利用&lt;code&gt;Javassist&lt;/code&gt;实现类增强&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2019/06/05/Javassist%E5%8A%A8</summary>
      
    
    
    
    <category term="程序设计" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    
    <category term="后端" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Java" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/%E5%90%8E%E7%AB%AF/Java/"/>
    
    <category term="Javassist" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/%E5%90%8E%E7%AB%AF/Java/Javassist/"/>
    
    
    <category term="Java" scheme="https://linweiyuan.github.io/tags/Java/"/>
    
    <category term="Javassist" scheme="https://linweiyuan.github.io/tags/Javassist/"/>
    
    <category term="Reflection" scheme="https://linweiyuan.github.io/tags/Reflection/"/>
    
  </entry>
  
  <entry>
    <title>Maven上传Nexus私服带源码</title>
    <link href="https://linweiyuan.github.io/2019/06/03/Maven%E4%B8%8A%E4%BC%A0Nexus%E7%A7%81%E6%9C%8D%E5%B8%A6%E6%BA%90%E7%A0%81.html"/>
    <id>https://linweiyuan.github.io/2019/06/03/Maven%E4%B8%8A%E4%BC%A0Nexus%E7%A7%81%E6%9C%8D%E5%B8%A6%E6%BA%90%E7%A0%81.html</id>
    <published>2019-06-03T08:26:59.000Z</published>
    <updated>2022-09-23T18:38:44.661Z</updated>
    
    <content type="html"><![CDATA[<p>加<code>maven-source-plugin</code>插件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-source-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">attach</span>&gt;</span>true<span class="tag">&lt;/<span class="name">attach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>settings.xml</code>配置验证信息</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>id<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">username</span>&gt;</span>username<span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">password</span>&gt;</span>password<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>pom.xml</code>中的<code>id</code>要和<code>settings.xml</code>中的一致</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">distributionManagement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>id<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>url<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">distributionManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;加&lt;code&gt;maven-source-plugin&lt;/code&gt;插件&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;</summary>
      
    
    
    
    <category term="构建工具" scheme="https://linweiyuan.github.io/categories/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="Maven" scheme="https://linweiyuan.github.io/tags/Maven/"/>
    
    <category term="Nexus" scheme="https://linweiyuan.github.io/tags/Nexus/"/>
    
  </entry>
  
  <entry>
    <title>Java定时器</title>
    <link href="https://linweiyuan.github.io/2019/05/21/Java%E5%AE%9A%E6%97%B6%E5%99%A8.html"/>
    <id>https://linweiyuan.github.io/2019/05/21/Java%E5%AE%9A%E6%97%B6%E5%99%A8.html</id>
    <published>2019-05-21T18:20:09.000Z</published>
    <updated>2022-09-23T18:38:44.661Z</updated>
    
    <content type="html"><![CDATA[<p>简单起见用<code>Kotlin</code>写</p><h3 id="scheduleAtFixedRate"><a href="#scheduleAtFixedRate" class="headerlink" title="scheduleAtFixedRate"></a>scheduleAtFixedRate</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> timerTaskPool = Executors.newScheduledThreadPool(<span class="number">2</span>)</span><br><span class="line">timerTaskPool.scheduleAtFixedRate(</span><br><span class="line">    <span class="keyword">object</span> : TimerTask() &#123;</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">run</span><span class="params">()</span></span> &#123;</span><br><span class="line">            println(Date())</span><br><span class="line">            Thread.sleep(<span class="number">2000</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="number">0</span>,</span><br><span class="line">    <span class="number">3</span>, TimeUnit.SECONDS</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Wed May 22 02:24:52 CST 2019</span><br><span class="line">Wed May 22 02:24:55 CST 2019</span><br><span class="line">Wed May 22 02:24:58 CST 2019</span><br></pre></td></tr></table></figure><p>也就是不顾前面的任务有没执行完, 延迟指定时间就再次执行任务</p><h3 id="scheduleWithFixedDelay"><a href="#scheduleWithFixedDelay" class="headerlink" title="scheduleWithFixedDelay"></a>scheduleWithFixedDelay</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> timerTaskPool = Executors.newScheduledThreadPool(<span class="number">2</span>)</span><br><span class="line">timerTaskPool.scheduleWithFixedDelay(</span><br><span class="line">    <span class="keyword">object</span> : TimerTask() &#123;</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">run</span><span class="params">()</span></span> &#123;</span><br><span class="line">            println(Date())</span><br><span class="line">            Thread.sleep(<span class="number">2000</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="number">0</span>,</span><br><span class="line">    <span class="number">3</span>, TimeUnit.SECONDS</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Wed May 22 02:26:04 CST 2019</span><br><span class="line">Wed May 22 02:26:09 CST 2019</span><br><span class="line">Wed May 22 02:26:14 CST 2019</span><br></pre></td></tr></table></figure><p>延迟 3 秒, 睡了 2 秒, 间隔 5 秒</p><p>定时任务尽量用 Pool, 因为 Timer 在分布式系统上可能存在时间不一致或者无法捕获异常的问题</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;简单起见用&lt;code&gt;Kotlin&lt;/code&gt;写&lt;/p&gt;
&lt;h3 id=&quot;scheduleAtFixedRate&quot;&gt;&lt;a href=&quot;#scheduleAtFixedRate&quot; class=&quot;headerlink&quot; title=&quot;scheduleAtFixedRate&quot;&gt;</summary>
      
    
    
    
    <category term="程序设计" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    
    
    <category term="Kotlin" scheme="https://linweiyuan.github.io/tags/Kotlin/"/>
    
    <category term="Java" scheme="https://linweiyuan.github.io/tags/Java/"/>
    
    <category term="ThreadPool" scheme="https://linweiyuan.github.io/tags/ThreadPool/"/>
    
  </entry>
  
  <entry>
    <title>Flask Dockerfile模板</title>
    <link href="https://linweiyuan.github.io/2019/05/20/Flask-Dockerfile%E6%A8%A1%E6%9D%BF.html"/>
    <id>https://linweiyuan.github.io/2019/05/20/Flask-Dockerfile%E6%A8%A1%E6%9D%BF.html</id>
    <published>2019-05-20T12:20:48.000Z</published>
    <updated>2022-09-23T18:38:44.657Z</updated>
    
    <content type="html"><![CDATA[<p><code>python:alpine</code>基于 Python3, 依赖下载过程中需要 build, 安装<code>python3-dev</code>,<code>build-base</code>,<code>gcc</code>, build 完后删掉, 镜像可减少几百 M</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> python:alpine</span><br><span class="line"></span><br><span class="line"><span class="keyword">LABEL</span><span class="language-bash"> maintainer=<span class="string">&quot;linweiyuan &lt;root@linweiyuan.com&gt;&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> FOLDER 项目名字</span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . <span class="variable">$&#123;FOLDER&#125;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> <span class="variable">$&#123;FOLDER&#125;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> sed -i <span class="string">&#x27;s/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g&#x27;</span> /etc/apk/repositories \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; apk add --no-cache python3-dev build-base gcc \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; pip install --no-cache-dir -r requirements.txt \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; apk del python3-dev build-base gcc</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">5000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;flask&quot;</span>,<span class="string">&quot;run&quot;</span>,<span class="string">&quot;--host=0.0.0.0&quot;</span>]</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;python:alpine&lt;/code&gt;基于 Python3, 依赖下载过程中需要 build, 安装&lt;code&gt;python3-dev&lt;/code&gt;,&lt;code&gt;build-base&lt;/code&gt;,&lt;code&gt;gcc&lt;/code&gt;, build 完后删掉, 镜</summary>
      
    
    
    
    <category term="程序设计" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    
    
    <category term="Python" scheme="https://linweiyuan.github.io/tags/Python/"/>
    
    <category term="Flask" scheme="https://linweiyuan.github.io/tags/Flask/"/>
    
    <category term="Dockerfile" scheme="https://linweiyuan.github.io/tags/Dockerfile/"/>
    
  </entry>
  
  <entry>
    <title>Go日期格式化</title>
    <link href="https://linweiyuan.github.io/2019/05/19/Go%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E5%8C%96.html"/>
    <id>https://linweiyuan.github.io/2019/05/19/Go%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E5%8C%96.html</id>
    <published>2019-05-19T16:24:52.000Z</published>
    <updated>2022-09-23T18:38:44.657Z</updated>
    
    <content type="html"><![CDATA[<p>文档 -&gt; <a href="https://golang.org/pkg/time/#Time.Format">time - The Go Programming Language</a></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time.Now().Format(<span class="string">&quot;2006-01-02 15:04:05&quot;</span>)</span><br></pre></td></tr></table></figure><p>真是一股清流</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;文档 -&amp;gt; &lt;a href=&quot;https://golang.org/pkg/time/#Time.Format&quot;&gt;time - The Go Programming Language&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight go&quot;&gt;&lt;tabl</summary>
      
    
    
    
    <category term="程序设计" scheme="https://linweiyuan.github.io/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
    
    
    <category term="Go" scheme="https://linweiyuan.github.io/tags/Go/"/>
    
  </entry>
  
</feed>
