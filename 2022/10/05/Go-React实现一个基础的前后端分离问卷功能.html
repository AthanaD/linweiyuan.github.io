<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>Go+React实现一个基础的前后端分离问卷功能 | 林伟源的技术博客</title><meta name="description" content="效果图 后端前期准备取一个随便点的名字 1234mkdir goquestionapicd goquestionapigit initgo mod init github.com&#x2F;linweiyuan&#x2F;goquestionapi  这里和数据库相关的操作会使用两个工具，migrate 和 sqlc，可以用 go 的方式安装，但这边习惯用 pacman，因为包升级好管理 12sudo pacman"><meta property="og:type" content="article"><meta property="og:title" content="Go+React实现一个基础的前后端分离问卷功能"><meta property="og:url" content="https://linweiyuan.github.io/2022/10/05/Go-React%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%9F%BA%E7%A1%80%E7%9A%84%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%97%AE%E5%8D%B7%E5%8A%9F%E8%83%BD.html"><meta property="og:site_name" content="林伟源的技术博客"><meta property="og:description" content="效果图 后端前期准备取一个随便点的名字 1234mkdir goquestionapicd goquestionapigit initgo mod init github.com&#x2F;linweiyuan&#x2F;goquestionapi  这里和数据库相关的操作会使用两个工具，migrate 和 sqlc，可以用 go 的方式安装，但这边习惯用 pacman，因为包升级好管理 12sudo pacman"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://linweiyuan.github.io/2022/10/05/Go-React%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%9F%BA%E7%A1%80%E7%9A%84%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%97%AE%E5%8D%B7%E5%8A%9F%E8%83%BD/screenshot.png"><meta property="article:published_time" content="2022-10-05T04:13:39.000Z"><meta property="article:modified_time" content="2023-01-19T01:22:13.851Z"><meta property="article:author" content="林伟源"><meta property="article:tag" content="Go"><meta property="article:tag" content="React"><meta property="article:tag" content="sqlc"><meta property="article:tag" content="Postgres"><meta property="article:tag" content="Gin"><meta property="article:tag" content="Ant Design"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://linweiyuan.github.io/2022/10/05/Go-React%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%9F%BA%E7%A1%80%E7%9A%84%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%97%AE%E5%8D%B7%E5%8A%9F%E8%83%BD/screenshot.png"><link rel="canonical" href="https://linweiyuan.github.io/2022/10/05/Go-React%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%9F%BA%E7%A1%80%E7%9A%84%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%97%AE%E5%8D%B7%E5%8A%9F%E8%83%BD.html"><link rel="alternate" href="/atom.xml" title="林伟源的技术博客" type="application/atom+xml"><link rel="icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 6.3.0"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/linweiyuan" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.png" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">林伟源</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> 广州</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">首页</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">归档</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">分类</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">标签</span></a></li><li class="menu-item menu-item-repository"><a href="/repository"><i class="icon icon-project"></i> <span class="menu-title">项目</span></a></li><li class="menu-item menu-item-links"><a href="/links"><i class="icon icon-friendship"></i> <span class="menu-title">友链</span></a></li><li class="menu-item menu-item-about"><a href="/about"><i class="icon icon-cup-fill"></i> <span class="menu-title">关于</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/linweiyuan" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">分类</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ELK/">ELK</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Github-Actions/">Github Actions</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JVM/">JVM</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7/">实用技巧</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/">容器技术</a><span class="category-list-count">13</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/Kubernetes/">Kubernetes</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/">构建工具</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/">架构设计</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">消息队列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/">版本控制</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A4%BE%E5%8C%BA%E6%B4%BB%E5%8A%A8/">社区活动</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/">程序设计</a><span class="category-list-count">40</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/Java/">Java</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/Kotlin/">Kotlin</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%99%9A%E6%8B%9F%E6%9C%BA/">虚拟机</a><span class="category-list-count">4</span></li></ul></div></div><div class="widget"><h3 class="widget-title">标签</h3><div class="widget-body"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ASPX/" rel="tag">ASPX</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AVD/" rel="tag">AVD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/" rel="tag">Android</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AngularJS/" rel="tag">AngularJS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Anko/" rel="tag">Anko</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ant/" rel="tag">Ant</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ant-Design/" rel="tag">Ant Design</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Arch-Linux/" rel="tag">Arch Linux</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BASE/" rel="tag">BASE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CAP/" rel="tag">CAP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CORS/" rel="tag">CORS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CentOS/" rel="tag">CentOS</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cookie/" rel="tag">Cookie</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CoreOS/" rel="tag">CoreOS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker-Compose/" rel="tag">Docker Compose</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dockerfile/" rel="tag">Dockerfile</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elasticsearch/" rel="tag">Elasticsearch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FFmpeg/" rel="tag">FFmpeg</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fcitx/" rel="tag">Fcitx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Feign/" rel="tag">Feign</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flask/" rel="tag">Flask</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gin/" rel="tag">Gin</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GitLab/" rel="tag">GitLab</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Github-Actions/" rel="tag">Github Actions</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Go/" rel="tag">Go</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Golang/" rel="tag">Golang</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Google-Drive/" rel="tag">Google Drive</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hystrix/" rel="tag">Hystrix</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IDEA/" rel="tag">IDEA</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ingress/" rel="tag">Ingress</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IntelliJ-IDEA-Conf/" rel="tag">IntelliJ IDEA Conf</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JDK/" rel="tag">JDK</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JDK18/" rel="tag">JDK18</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JEECG/" rel="tag">JEECG</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSP/" rel="tag">JSP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSPX/" rel="tag">JSPX</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/" rel="tag">JVM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Javassist/" rel="tag">Javassist</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jenkins/" rel="tag">Jenkins</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KDE/" rel="tag">KDE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KVM/" rel="tag">KVM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kibana/" rel="tag">Kibana</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kotlin/" rel="tag">Kotlin</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kubernetes/" rel="tag">Kubernetes</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Logstash/" rel="tag">Logstash</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MVCC/" rel="tag">MVCC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Manjaro/" rel="tag">Manjaro</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Maven/" rel="tag">Maven</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongoDB/" rel="tag">MongoDB</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NIO/" rel="tag">NIO</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NTFS/" rel="tag">NTFS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Netty/" rel="tag">Netty</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nextcloud/" rel="tag">Nextcloud</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nexus/" rel="tag">Nexus</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/" rel="tag">Nginx</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/" rel="tag">Node.js</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nvidia/" rel="tag">Nvidia</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle/" rel="tag">Oracle</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle-XE/" rel="tag">Oracle-XE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pod/" rel="tag">Pod</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Postgres/" rel="tag">Postgres</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Privoxy/" rel="tag">Privoxy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/QEMU/" rel="tag">QEMU</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RTL8192EU/" rel="tag">RTL8192EU</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RabbitMQ/" rel="tag">RabbitMQ</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rancher/" rel="tag">Rancher</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/" rel="tag">React</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reflection/" rel="tag">Reflection</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Registry/" rel="tag">Registry</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Server-Send-Event/" rel="tag">Server Send Event</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Session/" rel="tag">Session</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shell/" rel="tag">Shell</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Snowflake/" rel="tag">Snowflake</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Socket/" rel="tag">Socket</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/" rel="tag">Spring</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Boot/" rel="tag">Spring Boot</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Boot-Starter/" rel="tag">Spring Boot Starter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Cloud/" rel="tag">Spring Cloud</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swing/" rel="tag">Swing</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Thread/" rel="tag">Thread</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ThreadPool/" rel="tag">ThreadPool</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TigerVNC/" rel="tag">TigerVNC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tomcat/" rel="tag">Tomcat</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UDP/" rel="tag">UDP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UUID/" rel="tag">UUID</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unauthorized/" rel="tag">Unauthorized</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VirtIO/" rel="tag">VirtIO</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VirtualBox/" rel="tag">VirtualBox</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vulnerability/" rel="tag">Vulnerability</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WeChatPay/" rel="tag">WeChatPay</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebLogic/" rel="tag">WebLogic</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebSocket/" rel="tag">WebSocket</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Wget/" rel="tag">Wget</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/" rel="tag">Windows</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XSS/" rel="tag">XSS</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ZooKeeper/" rel="tag">ZooKeeper</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zuul/" rel="tag">Zuul</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cURL/" rel="tag">cURL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deepin-wechat/" rel="tag">deepin-wechat</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/i3/" rel="tag">i3</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/i3bar/" rel="tag">i3bar</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/i3status/" rel="tag">i3status</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/" rel="tag">jQuery</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jsoup/" rel="tag">jsoup</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openssl/" rel="tag">openssl</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pgAdmin/" rel="tag">pgAdmin</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pip/" rel="tag">pip</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlc/" rel="tag">sqlc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/war/" rel="tag">war</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/youtube-dl/" rel="tag">youtube-dl</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8FID/" rel="tag">分布式ID</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" rel="tag">分布式事务</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/" rel="tag">分布式锁</a><span class="tag-list-count">1</span></li></ul></div></div><div class="widget"><h3 class="widget-title">标签云</h3><div class="widget-body tagcloud"><a href="/tags/ASPX/" style="font-size:13px">ASPX</a> <a href="/tags/AVD/" style="font-size:13px">AVD</a> <a href="/tags/Android/" style="font-size:13.27px">Android</a> <a href="/tags/AngularJS/" style="font-size:13.09px">AngularJS</a> <a href="/tags/Anko/" style="font-size:13px">Anko</a> <a href="/tags/Ant/" style="font-size:13px">Ant</a> <a href="/tags/Ant-Design/" style="font-size:13px">Ant Design</a> <a href="/tags/Arch-Linux/" style="font-size:13.91px">Arch Linux</a> <a href="/tags/BASE/" style="font-size:13px">BASE</a> <a href="/tags/CAP/" style="font-size:13px">CAP</a> <a href="/tags/CORS/" style="font-size:13px">CORS</a> <a href="/tags/CentOS/" style="font-size:13.36px">CentOS</a> <a href="/tags/Cookie/" style="font-size:13px">Cookie</a> <a href="/tags/CoreOS/" style="font-size:13px">CoreOS</a> <a href="/tags/Docker/" style="font-size:13.82px">Docker</a> <a href="/tags/Docker-Compose/" style="font-size:13px">Docker Compose</a> <a href="/tags/Dockerfile/" style="font-size:13px">Dockerfile</a> <a href="/tags/Elasticsearch/" style="font-size:13px">Elasticsearch</a> <a href="/tags/FFmpeg/" style="font-size:13px">FFmpeg</a> <a href="/tags/Fcitx/" style="font-size:13px">Fcitx</a> <a href="/tags/Feign/" style="font-size:13px">Feign</a> <a href="/tags/Flask/" style="font-size:13px">Flask</a> <a href="/tags/Gin/" style="font-size:13px">Gin</a> <a href="/tags/Git/" style="font-size:13.55px">Git</a> <a href="/tags/GitLab/" style="font-size:13px">GitLab</a> <a href="/tags/Github-Actions/" style="font-size:13px">Github Actions</a> <a href="/tags/Go/" style="font-size:13.18px">Go</a> <a href="/tags/Golang/" style="font-size:13.18px">Golang</a> <a href="/tags/Google-Drive/" style="font-size:13px">Google Drive</a> <a href="/tags/Hystrix/" style="font-size:13px">Hystrix</a> <a href="/tags/IDEA/" style="font-size:13.18px">IDEA</a> <a href="/tags/Ingress/" style="font-size:13px">Ingress</a> <a href="/tags/IntelliJ-IDEA-Conf/" style="font-size:13px">IntelliJ IDEA Conf</a> <a href="/tags/JDK/" style="font-size:13px">JDK</a> <a href="/tags/JDK18/" style="font-size:13px">JDK18</a> <a href="/tags/JEECG/" style="font-size:13px">JEECG</a> <a href="/tags/JSP/" style="font-size:13px">JSP</a> <a href="/tags/JSPX/" style="font-size:13.09px">JSPX</a> <a href="/tags/JVM/" style="font-size:13px">JVM</a> <a href="/tags/Java/" style="font-size:14px">Java</a> <a href="/tags/Javassist/" style="font-size:13px">Javassist</a> <a href="/tags/Jenkins/" style="font-size:13px">Jenkins</a> <a href="/tags/KDE/" style="font-size:13px">KDE</a> <a href="/tags/KVM/" style="font-size:13px">KVM</a> <a href="/tags/Kibana/" style="font-size:13px">Kibana</a> <a href="/tags/Kotlin/" style="font-size:13.55px">Kotlin</a> <a href="/tags/Kubernetes/" style="font-size:13.36px">Kubernetes</a> <a href="/tags/Linux/" style="font-size:13.91px">Linux</a> <a href="/tags/Logstash/" style="font-size:13px">Logstash</a> <a href="/tags/MVCC/" style="font-size:13px">MVCC</a> <a href="/tags/Manjaro/" style="font-size:13px">Manjaro</a> <a href="/tags/Maven/" style="font-size:13.18px">Maven</a> <a href="/tags/MongoDB/" style="font-size:13px">MongoDB</a> <a href="/tags/MySQL/" style="font-size:13.73px">MySQL</a> <a href="/tags/NIO/" style="font-size:13.09px">NIO</a> <a href="/tags/NTFS/" style="font-size:13px">NTFS</a> <a href="/tags/Netty/" style="font-size:13.09px">Netty</a> <a href="/tags/Nextcloud/" style="font-size:13px">Nextcloud</a> <a href="/tags/Nexus/" style="font-size:13px">Nexus</a> <a href="/tags/Nginx/" style="font-size:13.45px">Nginx</a> <a href="/tags/Node-js/" style="font-size:13px">Node.js</a> <a href="/tags/Nvidia/" style="font-size:13px">Nvidia</a> <a href="/tags/Oracle/" style="font-size:13.18px">Oracle</a> <a href="/tags/Oracle-XE/" style="font-size:13px">Oracle-XE</a> <a href="/tags/Pod/" style="font-size:13px">Pod</a> <a href="/tags/Postgres/" style="font-size:13px">Postgres</a> <a href="/tags/Privoxy/" style="font-size:13px">Privoxy</a> <a href="/tags/Python/" style="font-size:13.09px">Python</a> <a href="/tags/QEMU/" style="font-size:13px">QEMU</a> <a href="/tags/RTL8192EU/" style="font-size:13px">RTL8192EU</a> <a href="/tags/RabbitMQ/" style="font-size:13.09px">RabbitMQ</a> <a href="/tags/Rancher/" style="font-size:13px">Rancher</a> <a href="/tags/React/" style="font-size:13px">React</a> <a href="/tags/Redis/" style="font-size:13.55px">Redis</a> <a href="/tags/Reflection/" style="font-size:13px">Reflection</a> <a href="/tags/Registry/" style="font-size:13px">Registry</a> <a href="/tags/SQL/" style="font-size:13.09px">SQL</a> <a href="/tags/Server-Send-Event/" style="font-size:13px">Server Send Event</a> <a href="/tags/Session/" style="font-size:13px">Session</a> <a href="/tags/Shell/" style="font-size:13.09px">Shell</a> <a href="/tags/Snowflake/" style="font-size:13px">Snowflake</a> <a href="/tags/Socket/" style="font-size:13px">Socket</a> <a href="/tags/Spring/" style="font-size:13px">Spring</a> <a href="/tags/Spring-Boot/" style="font-size:13.36px">Spring Boot</a> <a href="/tags/Spring-Boot-Starter/" style="font-size:13px">Spring Boot Starter</a> <a href="/tags/Spring-Cloud/" style="font-size:13.18px">Spring Cloud</a> <a href="/tags/Swing/" style="font-size:13px">Swing</a> <a href="/tags/Thread/" style="font-size:13px">Thread</a> <a href="/tags/ThreadPool/" style="font-size:13px">ThreadPool</a> <a href="/tags/TigerVNC/" style="font-size:13px">TigerVNC</a> <a href="/tags/Tomcat/" style="font-size:13.09px">Tomcat</a> <a href="/tags/UDP/" style="font-size:13px">UDP</a> <a href="/tags/UUID/" style="font-size:13px">UUID</a> <a href="/tags/Unauthorized/" style="font-size:13px">Unauthorized</a> <a href="/tags/VirtIO/" style="font-size:13px">VirtIO</a> <a href="/tags/VirtualBox/" style="font-size:13.18px">VirtualBox</a> <a href="/tags/Vulnerability/" style="font-size:13.64px">Vulnerability</a> <a href="/tags/WeChatPay/" style="font-size:13px">WeChatPay</a> <a href="/tags/WebLogic/" style="font-size:13.09px">WebLogic</a> <a href="/tags/WebSocket/" style="font-size:13px">WebSocket</a> <a href="/tags/Wget/" style="font-size:13px">Wget</a> <a href="/tags/Windows/" style="font-size:13.09px">Windows</a> <a href="/tags/XSS/" style="font-size:13.18px">XSS</a> <a href="/tags/ZooKeeper/" style="font-size:13px">ZooKeeper</a> <a href="/tags/Zuul/" style="font-size:13px">Zuul</a> <a href="/tags/cURL/" style="font-size:13px">cURL</a> <a href="/tags/deepin-wechat/" style="font-size:13px">deepin-wechat</a> <a href="/tags/i3/" style="font-size:13.18px">i3</a> <a href="/tags/i3bar/" style="font-size:13px">i3bar</a> <a href="/tags/i3status/" style="font-size:13px">i3status</a> <a href="/tags/jQuery/" style="font-size:13px">jQuery</a> <a href="/tags/jsoup/" style="font-size:13.09px">jsoup</a> <a href="/tags/openssl/" style="font-size:13px">openssl</a> <a href="/tags/pgAdmin/" style="font-size:13px">pgAdmin</a> <a href="/tags/pip/" style="font-size:13px">pip</a> <a href="/tags/sqlc/" style="font-size:13px">sqlc</a> <a href="/tags/war/" style="font-size:13px">war</a> <a href="/tags/youtube-dl/" style="font-size:13px">youtube-dl</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8FID/" style="font-size:13px">分布式ID</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" style="font-size:13px">分布式事务</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/" style="font-size:13px">分布式锁</a></div></div><div class="widget"><h3 class="widget-title">归档</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">四月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">七月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a><span class="archive-list-count">9</span></li></ul></div></div><div class="widget"><h3 class="widget-title">最新文章</h3><div class="widget-body"><ul class="recent-post-list list-unstyled no-thumbnail"><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/">程序设计</a></p><p class="item-title"><a href="/2023/01/01/Effective-Java.html" class="title">Effective Java</a></p><p class="item-date"><time datetime="2023-01-01T08:14:46.000Z" itemprop="datePublished">2023-01-01</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E8%99%9A%E6%8B%9F%E6%9C%BA/">虚拟机</a></p><p class="item-title"><a href="/2022/11/25/%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A-PCI-passthrough-via-OVMF.html" class="title">虚拟机显卡直通 (PCI passthrough via OVMF)</a></p><p class="item-date"><time datetime="2022-11-25T02:23:36.000Z" itemprop="datePublished">2022-11-25</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/">架构设计</a></p><p class="item-title"><a href="/2022/11/05/%E5%88%86%E5%B8%83%E5%BC%8F%E7%9B%B8%E5%85%B3%E5%AE%9E%E8%B7%B5.html" class="title">分布式相关实践</a></p><p class="item-date"><time datetime="2022-11-05T06:21:07.000Z" itemprop="datePublished">2022-11-05</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/">程序设计</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/Kotlin/">Kotlin</a></p><p class="item-title"><a href="/2022/10/15/%E8%87%AA%E5%AE%9A%E4%B9%89starter%E5%A4%84%E7%90%86%E5%BC%82%E5%B8%B8%E5%92%8C%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94%E6%97%A5%E5%BF%97.html" class="title">自定义starter处理异常和请求响应日志</a></p><p class="item-date"><time datetime="2022-10-15T17:35:34.000Z" itemprop="datePublished">2022-10-16</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/">程序设计</a></p><p class="item-title"><a href="/2022/10/05/Go-React%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%9F%BA%E7%A1%80%E7%9A%84%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%97%AE%E5%8D%B7%E5%8A%9F%E8%83%BD.html" class="title">Go+React实现一个基础的前后端分离问卷功能</a></p><p class="item-date"><time datetime="2022-10-05T04:13:39.000Z" itemprop="datePublished">2022-10-05</time></p></div></li></ul></div></div></div></aside><main class="main" role="main"><div class="content"><article id="post-Go-React实现一个基础的前后端分离问卷功能" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">Go+React实现一个基础的前后端分离问卷功能</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2022/10/05/Go-React%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%9F%BA%E7%A1%80%E7%9A%84%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%97%AE%E5%8D%B7%E5%8A%9F%E8%83%BD.html" class="article-date"><time datetime="2022-10-05T04:13:39.000Z" itemprop="datePublished">2022-10-05</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/">程序设计</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/Ant-Design/" rel="tag">Ant Design</a>, <a class="article-tag-link-link" href="/tags/Gin/" rel="tag">Gin</a>, <a class="article-tag-link-link" href="/tags/Go/" rel="tag">Go</a>, <a class="article-tag-link-link" href="/tags/Postgres/" rel="tag">Postgres</a>, <a class="article-tag-link-link" href="/tags/React/" rel="tag">React</a>, <a class="article-tag-link-link" href="/tags/sqlc/" rel="tag">sqlc</a> </span><span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 5.9k(字)</span> <span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 27(分)</span></div></div><div class="article-entry marked-body" itemprop="articleBody"><h1 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h1><p><img src="/2022/10/05/Go-React%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%9F%BA%E7%A1%80%E7%9A%84%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%97%AE%E5%8D%B7%E5%8A%9F%E8%83%BD/screenshot.png"></p><h1 id="后端"><a href="#后端" class="headerlink" title="后端"></a>后端</h1><h2 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h2><p>取一个随便点的名字</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> goquestionapi</span><br><span class="line"><span class="built_in">cd</span> goquestionapi</span><br><span class="line">git init</span><br><span class="line">go mod init github.com/linweiyuan/goquestionapi</span><br></pre></td></tr></table></figure><p>这里和数据库相关的操作会使用两个工具，<code>migrate</code> 和 <code>sqlc</code>，可以用 go 的方式安装，但这边习惯用 pacman，因为包升级好管理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S sqlc</span><br><span class="line">yay -S migrate</span><br></pre></td></tr></table></figure><p>sqlc 是一个代码生成工具，生成的代码中连接数据库的部分用的是 Golang 原生 sql 库，性能极高（官方是这样说的）</p><p>为什么不用 GORM，因为由于多年 Java 开发经验先入为主，看到 GORM 的 API 好多时候会觉得莫名其妙，尝试过几遍，都弃坑了，并且据说有性能问题</p><p>sqlc 可以通过编写简单的 SQL 语句，来自动生成模板代码，那么只需要关注具体的业务逻辑即可，并且可以通过 sqlc.arg() 的方式给占位符起别名，使用起来比较顺手</p><p>数据库用的是 Postgres</p><p>对于这种一个问题多个答案，一对多的结构，其实我自己比较喜欢用 JSON 字段</p><p>为什么不直接用 MongoDB？其实工作多年接触的项目，只用过一次，不是很熟悉</p><p>为什么不用 MySQL？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CONTAINER ID   NAME                 CPU %     MEM USAGE / LIMIT     MEM %     NET I/O          BLOCK I/O        PIDS</span><br><span class="line">2057f98237b3   postgres             0.02%     28.57MiB / 15.49GiB   0.18%     3.03kB / 0B      0B / 43.4MB      7</span><br><span class="line">25959b7d7133   mysql                0.27%     159.5MiB / 15.49GiB   1.01%     6.85kB / 0B      115kB / 259MB    39</span><br><span class="line">ef2ecd22745f   mongo                0.30%     68.66MiB / 15.49GiB   0.43%     8.25kB / 0B      4.1kB / 1.29MB   33</span><br></pre></td></tr></table></figure><p>如果开了 performance_schema 呢（默认是开）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CONTAINER ID   NAME                 CPU %     MEM USAGE / LIMIT     MEM %     NET I/O          BLOCK I/O        PIDS</span><br><span class="line">bb4ba1c34299   mysql                0.26%     383MiB / 15.49GiB     2.42%     2.5kB / 0B       115kB / 247MB    39</span><br></pre></td></tr></table></figure><p>练手而已</p><p>目前所在公司，新项目也纷纷上 Postgres，不涉及到那些储存过程函数之类，转换下 database schema 概念，其实用起来都没什么区别</p><p>准备数据，数据是从网上拿的，主要是一些问题，然后对应的选项写死了分值，最后根据总分来判断性格（性格测试这东西我本人觉得极为扯淡，有些公司面试还要做，莫名其妙，如果我所在公司也要做，那我前面什么都没说，这个测试好得很，必须做）</p><p>数据准备好，就可以导入数据库，这里用的是 migrate，所以先准备第一版的 SQL</p><p>sqlc 配置文件</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;2&quot;</span></span><br><span class="line"><span class="attr">sql:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">engine:</span> <span class="string">&quot;postgresql&quot;</span></span><br><span class="line">    <span class="attr">schema:</span> <span class="string">&quot;sqlc/migration&quot;</span></span><br><span class="line">    <span class="attr">queries:</span> <span class="string">&quot;sqlc/query&quot;</span></span><br><span class="line">    <span class="attr">gen:</span></span><br><span class="line">      <span class="attr">go:</span></span><br><span class="line">        <span class="attr">package:</span> <span class="string">&quot;sqlc&quot;</span></span><br><span class="line">        <span class="attr">out:</span> <span class="string">&quot;sqlc&quot;</span></span><br></pre></td></tr></table></figure><p>schema 是数据库建表、删表语句，queries 是业务 SQL 的编写地方，然后 package 是生成的 go 代码的包名，out 就是代码生成的文件夹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">migrate create -ext sql -<span class="built_in">dir</span> sqlc/migration -<span class="built_in">seq</span> init</span><br></pre></td></tr></table></figure><p>migrate 参数：</p><ul><li>-ext: 数据脚本扩展名（后缀名）</li><li>-dir: 脚本文件所在地，配合上面 sqlc 的配置文件就是在 sqlc&#x2F;migration 里</li><li>-seq: 就是一个 sequence，自增</li><li>最后是文件名字</li></ul><p>上面的命令就会生成 000001_init.down.sql 和 000001_init.up.sql 这两个文件，up 就是新改动，down 就是回滚，和别的数据库 migration 一样</p><p>首先需要先创建 schema，这里 schema 叫 question，表也叫 question（表则可以在 migration sql 里创建）</p><p>创建好 schema 之后 migrate 和 sqlc 才会好使，不然会有先有鸡还是先有蛋的问题</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> SCHEMA question;</span><br></pre></td></tr></table></figure><p>准备 up sql</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span></span><br><span class="line">    question (</span><br><span class="line">        id SERIAL <span class="keyword">PRIMARY</span> KEY <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">        title <span class="type">VARCHAR</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">        answer JSON <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">        score JSON <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span></span><br><span class="line">    question (title, answer, score)</span><br><span class="line"><span class="keyword">VALUES</span> (</span><br><span class="line">        <span class="string">&#x27;你更喜欢吃那种水果&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;草莓&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;苹果&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;西瓜&quot;,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: &quot;菠萝&quot;,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: &quot;橘子&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 2,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 3,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: 10,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: 15</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    ), (</span><br><span class="line">        <span class="string">&#x27;你平时休闲经常去的地方&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;郊外&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;电影院&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;公园&quot;,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: &quot;商场&quot;,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: &quot;酒吧&quot;,</span></span><br><span class="line"><span class="string">	&quot;F&quot;: &quot;练歌房&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 2,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 3,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: 10,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: 15,</span></span><br><span class="line"><span class="string">	&quot;F&quot;: 20</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    ), (</span><br><span class="line">        <span class="string">&#x27;你认为容易吸引你的人是&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;有才气的人&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;依赖你的人&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;优雅的人&quot;,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: &quot;善良的人&quot;,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: &quot;性情豪放的人&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 2,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 3,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: 10,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: 15</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    ), (</span><br><span class="line">        <span class="string">&#x27;如果你可以成为一种动物，你希望自己是哪种&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;猫&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;马&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;大象&quot;,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: &quot;猴子&quot;,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: &quot;狗&quot;,</span></span><br><span class="line"><span class="string">	&quot;F&quot;: &quot;狮子&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 2,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 3,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: 10,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: 15,</span></span><br><span class="line"><span class="string">	&quot;F&quot;: 20</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    ), (</span><br><span class="line">        <span class="string">&#x27;天气很热，你更愿意选择什么方式解暑&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;游泳&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;喝冷饮&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;开空调&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 10,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 15</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    ), (</span><br><span class="line">        <span class="string">&#x27;如果必须与一个你讨厌的动物或昆虫在一起生活，你能容忍哪一个&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;蛇&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;猪&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;老鼠&quot;,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: &quot;苍蝇&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 2,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 10,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: 15</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    ), (</span><br><span class="line">        <span class="string">&#x27;你喜欢看哪类电影、电视剧&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;悬疑推理类&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;童话神话类&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;自然科学类&quot;,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: &quot;伦理道德类&quot;,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: &quot;战争枪战类&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 2,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 3,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: 10,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: 15</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    ), (</span><br><span class="line">        <span class="string">&#x27;以下哪个是你身边必带的物品&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;打火机&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;口红&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;记事本&quot;,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: &quot;纸巾&quot;,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: &quot;手机&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 2,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 2,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 3,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: 10</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    ), (</span><br><span class="line">        <span class="string">&#x27;你出行时喜欢坐什么交通工具&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;火车&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;自行车&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;汽车&quot;,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: &quot;飞机&quot;,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: &quot;步行&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 2,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 3,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: 10,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: 15</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    ), (</span><br><span class="line">        <span class="string">&#x27;以下颜色你更喜欢哪种&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;紫&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;黑&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;蓝&quot;,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: &quot;白&quot;,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: &quot;黄&quot;,</span></span><br><span class="line"><span class="string">	&quot;F&quot;: &quot;红&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 2,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 3,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: 8,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: 12,</span></span><br><span class="line"><span class="string">	&quot;F&quot;: 15</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    ), (</span><br><span class="line">        <span class="string">&#x27;下列运动中挑选一个你最喜欢的（不一定擅长）&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;瑜珈&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;自行车&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;乒乓球&quot;,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: &quot;拳击&quot;,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: &quot;足球&quot;,</span></span><br><span class="line"><span class="string">	&quot;F&quot;: &quot;蹦极&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 2,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 3,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: 8,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: 10,</span></span><br><span class="line"><span class="string">	&quot;F&quot;: 15</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    ), (</span><br><span class="line">        <span class="string">&#x27;如果你拥有一座别墅，你认为它应当建立在哪里&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;湖边&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;草原&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;海边&quot;,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: &quot;森林&quot;,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: &quot;城中区&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 2,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 3,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: 10,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: 15</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    ), (</span><br><span class="line">        <span class="string">&#x27;你更喜欢以下哪种天气现象&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;雪&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;风&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;雨&quot;,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: &quot;雾&quot;,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: &quot;雷电&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 2,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 3,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: 10,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: 15</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    ), (</span><br><span class="line">        <span class="string">&#x27;你希望自己的窗口在一座30层大楼的第几层&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;七层&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;一层&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;二十三层&quot;,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: &quot;十八层&quot;,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: &quot;三十层&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 2,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 3,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: 10,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: 15</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    ), (</span><br><span class="line">        <span class="string">&#x27;你认为自己更喜欢在以下哪一个城市中生活&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: &quot;丽江&quot;,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: &quot;拉萨&quot;,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: &quot;昆明&quot;,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: &quot;西安&quot;,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: &quot;杭州&quot;,</span></span><br><span class="line"><span class="string">	&quot;F&quot;: &quot;北京&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">	&quot;A&quot;: 1,</span></span><br><span class="line"><span class="string">	&quot;B&quot;: 3,</span></span><br><span class="line"><span class="string">	&quot;C&quot;: 5,</span></span><br><span class="line"><span class="string">	&quot;D&quot;: 8,</span></span><br><span class="line"><span class="string">	&quot;E&quot;: 10,</span></span><br><span class="line"><span class="string">	&quot;F&quot;: 15</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br><span class="line">    );</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">migrate -path sqlc/migration -database <span class="string">&quot;postgresql://postgres:postgres@localhost:5432/postgres?sslmode=disable&amp;search_path=question&quot;</span> -verbose up</span><br></pre></td></tr></table></figure><p>down sql</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> question;</span><br></pre></td></tr></table></figure><p>同理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">migrate -path sqlc/migration -database <span class="string">&quot;postgresql://postgres:postgres@localhost:5432/postgres?sslmode=disable&amp;search_path=question&quot;</span> -verbose down</span><br></pre></td></tr></table></figure><p>接着就是编写获取问题列表的 SQL</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- name: GetQuestions :many</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> q.id, q.title, q.answer <span class="keyword">FROM</span> question q <span class="keyword">ORDER</span> <span class="keyword">BY</span> q.id;</span><br></pre></td></tr></table></figure><p>根据 sqlc 的规范，<code>-- name: 方法名</code>，这些空格都是必须的，如果返回一条数据就 <code>:one</code>，多条则 <code>:many</code>，如果只是增删，可以用 <code>:exec</code></p><p>执行 <code>sqlc generate</code></p><p>这样就会生成好几个 go 文件，其中生成的方法类似</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(q *Queries)</span></span> GetQuestions(ctx context.Context) ([]GetQuestionsRow, <span class="type">error</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但是每次都要输入这么长的命令，虽然可以键盘上下，但是有更好的方法，就是 <code>Makefile</code></p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">up:</span></span><br><span class="line">	migrate -path sqlc/migration -database <span class="string">&quot;postgresql://postgres:postgres@localhost:5432/postgres?sslmode=disable&amp;search_path=question&quot;</span> -verbose up</span><br><span class="line"></span><br><span class="line"><span class="section">down:</span></span><br><span class="line">	migrate -path sqlc/migration -database <span class="string">&quot;postgresql://postgres:postgres@localhost:5432/postgres?sslmode=disable&amp;search_path=question&quot;</span> -verbose down</span><br><span class="line"></span><br><span class="line"><span class="section">gen:</span></span><br><span class="line">	sqlc generate</span><br><span class="line"></span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: up down gen</span></span><br></pre></td></tr></table></figure><p><code>.PHONY</code> 的作用就是确保执行的是这里定义的命令，比如 Makefile 里定义个 ls，如果不加到 .PHONY 里，则执行的是系统的 ls</p><h2 id="编写业务逻辑"><a href="#编写业务逻辑" class="headerlink" title="编写业务逻辑"></a>编写业务逻辑</h2><p>定义配置类，用到了 <code>viper</code>，有一个好处就是 <code>AutomaticEnv()</code> 能够将环境变量覆盖掉代码配置，这样在部署的时候非常方便，日志则用了 logrus，可以设置不同的级别，还有颜色输出，Java 过来表示很亲切</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> util</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	log <span class="string">&quot;github.com/sirupsen/logrus&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/spf13/viper&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	configFileName   = <span class="string">&quot;app&quot;</span></span><br><span class="line">	configFileSuffix = <span class="string">&quot;env&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Config <span class="keyword">struct</span> &#123;</span><br><span class="line">	ServerPort <span class="type">string</span> <span class="string">`mapstructure:&quot;SERVER_PORT&quot;`</span></span><br><span class="line"></span><br><span class="line">	DBDriver <span class="type">string</span> <span class="string">`mapstructure:&quot;DB_DRIVER&quot;`</span></span><br><span class="line">	DBSource <span class="type">string</span> <span class="string">`mapstructure:&quot;DB_SOURCE&quot;`</span></span><br><span class="line"></span><br><span class="line">	LogLevel <span class="type">string</span> <span class="string">`mapstructure:&quot;LOG_LEVEL&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">LoadConfig</span><span class="params">(path <span class="type">string</span>)</span></span> (config Config) &#123;</span><br><span class="line">	viper.AddConfigPath(path)</span><br><span class="line">	viper.SetConfigName(configFileName)</span><br><span class="line">	viper.SetConfigType(configFileSuffix)</span><br><span class="line">	viper.AutomaticEnv()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err := viper.ReadInConfig(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatalf(<span class="string">&quot;failed to load config file: [%v]&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err := viper.Unmarshal(&amp;config); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatalf(<span class="string">&quot;failed to parse config file: [%v]&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	logLevel, err := log.ParseLevel(config.LogLevel)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatalf(<span class="string">&quot;failed to get log level: [%v]&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	log.SetLevel(logLevel)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后就可以开启调试了，可以 build 或者直接 run，或者用其他热加载的工具，这里用到了 <code>gowatch</code></p><p>直接执行 gowatch 就可以将终端晾在一边了，和前端开发的体验没什么区别，Java 就要重启，没用过 JRebel</p><p>此时访问本地 8080 就能得到 404 的正确响应了</p><p>接着加一个 <code>CORS</code> 的中间件，这里不加，前端就要 <code>proxy</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> middleware</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	log <span class="string">&quot;github.com/sirupsen/logrus&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CORS</span><span class="params">()</span></span> gin.HandlerFunc &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		log.Debug(<span class="string">&quot;handle cors...&quot;</span>)</span><br><span class="line"></span><br><span class="line">		ctx.Writer.Header().Set(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>)</span><br><span class="line">		ctx.Writer.Header().Set(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="string">&quot;*&quot;</span>)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> ctx.Request.Method == http.MethodOptions &#123;</span><br><span class="line">			ctx.AbortWithStatus(http.StatusNoContent)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		ctx.Next()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>给 server 加上</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server.Use(middleware.CORS())</span><br></pre></td></tr></table></figure><p>API</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> api</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/linweiyuan/goquestionapi/sqlc&quot;</span></span><br><span class="line">	log <span class="string">&quot;github.com/sirupsen/logrus&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> QuestionAPI <span class="keyword">struct</span> &#123;</span><br><span class="line">	db *sqlc.Queries</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewQuestionAPI</span><span class="params">(db *sqlc.Queries)</span></span> *QuestionAPI &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;QuestionAPI&#123;db&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(api *QuestionAPI)</span></span> GetQuestions(ctx *gin.Context) &#123;</span><br><span class="line">	questions, err := api.db.GetQuestions(ctx)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Errorf(<span class="string">&quot;failed to get questions: [%v]&quot;</span>, err)</span><br><span class="line">		ctx.JSON(http.StatusInternalServerError, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">		&#125;)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ctx.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">		<span class="string">&quot;questions&quot;</span>: questions,</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>路由配置</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> router</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/linweiyuan/goquestionapi/api&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> QuestionRouter <span class="keyword">struct</span> &#123;</span><br><span class="line">	api *api.QuestionAPI</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewQuestionRouter</span><span class="params">(api *api.QuestionAPI)</span></span> *QuestionRouter &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;QuestionRouter&#123;api&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(router *QuestionRouter)</span></span> Setup(routerGroup *gin.RouterGroup) &#123;</span><br><span class="line">	group := routerGroup.Group(<span class="string">&quot;/questions&quot;</span>)</span><br><span class="line">	group.GET(<span class="string">&quot;&quot;</span>, router.api.GetQuestions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>给 server 加上，并且让其具有查询 db 的功能</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sqlDB, err := sql.Open(config.DBDriver, config.DBSource)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    log.Fatalf(<span class="string">&quot;failed to connect to DB: [%v]&quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">db := sqlc.New(sqlDB)</span><br><span class="line"></span><br><span class="line">rg := server.Group(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">router.NewQuestionRouter(api.NewQuestionAPI(db)).Setup(rg)</span><br></pre></td></tr></table></figure><p>需要注意一点就是，要让 db 的驱动执行初始化动作</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> _ <span class="string">&quot;github.com/lib/pq&quot;</span></span><br></pre></td></tr></table></figure><p>接着再访问 <code>http://localhost:8080/questions</code>，就能看到数据</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;questions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;ID&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;你更喜欢吃那种水果&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Answer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;A&quot;</span><span class="punctuation">:</span> <span class="string">&quot;草莓&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;B&quot;</span><span class="punctuation">:</span> <span class="string">&quot;苹果&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;C&quot;</span><span class="punctuation">:</span> <span class="string">&quot;西瓜&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;D&quot;</span><span class="punctuation">:</span> <span class="string">&quot;菠萝&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;E&quot;</span><span class="punctuation">:</span> <span class="string">&quot;橘子&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;ID&quot;</span><span class="punctuation">:</span> <span class="number">15</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;你认为自己更喜欢在以下哪一个城市中生活&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Answer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;A&quot;</span><span class="punctuation">:</span> <span class="string">&quot;丽江&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;B&quot;</span><span class="punctuation">:</span> <span class="string">&quot;拉萨&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;C&quot;</span><span class="punctuation">:</span> <span class="string">&quot;昆明&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;D&quot;</span><span class="punctuation">:</span> <span class="string">&quot;西安&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;E&quot;</span><span class="punctuation">:</span> <span class="string">&quot;杭州&quot;</span><span class="punctuation">,</span></span><br><span class="line">    	<span class="attr">&quot;F&quot;</span><span class="punctuation">:</span> <span class="string">&quot;北京&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>但是 json 的 key 全部大写了，可以在 sqlc 上配置 <code>emit_json_tags</code>，修改后的配置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;2&quot;</span></span><br><span class="line"><span class="attr">sql:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">engine:</span> <span class="string">&quot;postgresql&quot;</span></span><br><span class="line">    <span class="attr">schema:</span> <span class="string">&quot;sqlc/migration&quot;</span></span><br><span class="line">    <span class="attr">queries:</span> <span class="string">&quot;sqlc/query&quot;</span></span><br><span class="line">    <span class="attr">gen:</span></span><br><span class="line">      <span class="attr">go:</span></span><br><span class="line">        <span class="attr">package:</span> <span class="string">&quot;sqlc&quot;</span></span><br><span class="line">        <span class="attr">out:</span> <span class="string">&quot;sqlc&quot;</span></span><br><span class="line">        <span class="attr">emit_json_tags:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>再重新跑一遍 <code>make gen</code>，再刷新页面，就能拿到小写的 key，比较符合习惯</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;questions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;你更喜欢吃那种水果&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;answer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;A&quot;</span><span class="punctuation">:</span> <span class="string">&quot;草莓&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;B&quot;</span><span class="punctuation">:</span> <span class="string">&quot;苹果&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;C&quot;</span><span class="punctuation">:</span> <span class="string">&quot;西瓜&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;D&quot;</span><span class="punctuation">:</span> <span class="string">&quot;菠萝&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;E&quot;</span><span class="punctuation">:</span> <span class="string">&quot;橘子&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">15</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;你认为自己更喜欢在以下哪一个城市中生活&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;answer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;A&quot;</span><span class="punctuation">:</span> <span class="string">&quot;丽江&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;B&quot;</span><span class="punctuation">:</span> <span class="string">&quot;拉萨&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;C&quot;</span><span class="punctuation">:</span> <span class="string">&quot;昆明&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;D&quot;</span><span class="punctuation">:</span> <span class="string">&quot;西安&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;E&quot;</span><span class="punctuation">:</span> <span class="string">&quot;杭州&quot;</span><span class="punctuation">,</span></span><br><span class="line">    	<span class="attr">&quot;F&quot;</span><span class="punctuation">:</span> <span class="string">&quot;北京&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>至此获取问题列表 API 完成，接着是答题然后计算分数</p><p>这里用到下面的数据结构进行提交，思路还是逐条拿分数出来再叠加，没有太多花里胡哨的 SQL</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">	<span class="attr">&quot;answers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">		<span class="attr">&quot;1&quot;</span><span class="punctuation">:</span> <span class="string">&quot;A&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;2&quot;</span><span class="punctuation">:</span> <span class="string">&quot;B&quot;</span><span class="punctuation">,</span></span><br><span class="line">        ...</span><br><span class="line">		<span class="attr">&quot;15&quot;</span><span class="punctuation">:</span> <span class="string">&quot;C&quot;</span></span><br><span class="line">	<span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>于是根据题目拿分数的 SQL 就会是</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- name: GetQuestionScoreByID :one</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> (</span><br><span class="line">        q.score <span class="operator">-</span><span class="operator">&gt;&gt;</span> sqlc.arg(answer) :: TEXT</span><br><span class="line">    ) :: <span class="type">INT</span> <span class="keyword">AS</span> score</span><br><span class="line"><span class="keyword">FROM</span> question q</span><br><span class="line"><span class="keyword">WHERE</span> q.id <span class="operator">=</span> sqlc.arg(id);</span><br></pre></td></tr></table></figure><p>这里可以用 <code>$1</code>，<code>$2</code> 等的占位符，不过用 <code>sqlc.arg()</code> 就会更加顾名思义一些</p><p>再执行 <code>make gen</code>，生成新代码</p><p>接着编写完答题 API （练手而已，没有太多封装）</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> answersRequest <span class="keyword">struct</span> &#123;</span><br><span class="line">	Answers json.RawMessage <span class="string">`json:&quot;answers&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(api *QuestionAPI)</span></span> HandleAnswers(ctx *gin.Context) &#123;</span><br><span class="line">	<span class="keyword">var</span> req answersRequest</span><br><span class="line">	err := ctx.ShouldBindJSON(&amp;req)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Errorf(<span class="string">&quot;failed to bind answers json: [%v]&quot;</span>, err)</span><br><span class="line">		ctx.JSON(http.StatusBadRequest, util.HandleError(err))</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	totalScore := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	questionAnswerMap := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">int</span>]<span class="type">string</span>)</span><br><span class="line">	json.Unmarshal(req.Answers, &amp;questionAnswerMap)</span><br><span class="line">	<span class="keyword">for</span> questionID, answer := <span class="keyword">range</span> questionAnswerMap &#123;</span><br><span class="line">		getAnswerMappingParams := sqlc.GetQuestionScoreByIDParams&#123;</span><br><span class="line">			Answer: answer,</span><br><span class="line">			ID:     <span class="type">int32</span>(questionID),</span><br><span class="line">		&#125;</span><br><span class="line">		score, err := api.db.GetQuestionScoreByID(ctx, getAnswerMappingParams)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			log.Errorf(<span class="string">&quot;failed to get answer score, questionID: [%d], answer: [%s]&quot;</span>, questionID, answer)</span><br><span class="line">			ctx.JSON(http.StatusInternalServerError, util.HandleError(err))</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		totalScore += <span class="type">int</span>(score)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> result <span class="type">string</span></span><br><span class="line">	<span class="keyword">switch</span> &#123;</span><br><span class="line">	<span class="keyword">case</span> totalScore &gt;= <span class="number">180</span>:</span><br><span class="line">		result = <span class="string">&quot;意志力强，头脑冷静，有较强的领导欲，事业心强，不达目的不罢休。外表和善，内心自傲，对有利于自己的人际关系比较看重，有时显得性格急噪，咄咄逼人，得理不饶人，不利于自己时顽强抗争，不轻易认输。思维理性，对爱情和婚姻的看法很现实，对金钱的欲望一般。&quot;</span></span><br><span class="line">	<span class="keyword">case</span> totalScore &gt;= <span class="number">140</span> &amp;&amp; totalScore &lt; <span class="number">179</span>:</span><br><span class="line">		result = <span class="string">&quot;聪明，性格活泼，人缘好，善于交朋友，心机较深。事业心强，渴望成功。思维较理性，崇尚爱情，但当爱情与婚姻发生冲突时会选择有利于自己的婚姻。金钱欲望强烈。&quot;</span></span><br><span class="line">	<span class="keyword">case</span> totalScore &gt;= <span class="number">100</span> &amp;&amp; totalScore &lt; <span class="number">139</span>:</span><br><span class="line">		result = <span class="string">&quot;爱幻想，思维较感性，以是否与自己投缘为标准来选择朋友。性格显得较孤傲，有时较急噪，有时优柔寡断。事业心较强，喜欢有创造性的工作，不喜欢按常规办事。性格倔强，言语犀利，不善于妥协。崇尚浪漫的爱情，但想法往往不切合实际。金钱欲望一般。&quot;</span></span><br><span class="line">	<span class="keyword">case</span> totalScore &gt;= <span class="number">70</span> &amp;&amp; totalScore &lt; <span class="number">99</span>:</span><br><span class="line">		result = <span class="string">&quot;好奇心强，喜欢冒险，人缘较好。事业心一般，对待工作，随遇而安，善于妥协。善于发现有趣的事情，但耐心较差，敢于冒险，但有时较胆小。渴望浪漫的爱情，但对婚姻的要求比较现实。不善理财。&quot;</span></span><br><span class="line">	<span class="keyword">case</span> totalScore &gt;= <span class="number">40</span> &amp;&amp; totalScore &lt; <span class="number">69</span>:</span><br><span class="line">		result = <span class="string">&quot;性情温良，重友谊，性格塌实稳重，但有时也比较狡黠。事业心一般，对本职工作能认真对待，但对自己专业以外事物没有太大兴趣，喜欢有规律的工作和生活，不喜欢冒险，家庭观念强，比较善于理财。&quot;</span></span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		result = <span class="string">&quot;散漫，爱玩，富于幻想。聪明机灵，待人热情，爱交朋友，但对朋友没有严格的选择标准。事业心较差，更善于享受生活，意志力和耐心都较差，我行我素。有较好的异性缘，但对爱情不够坚持认真，容易妥协。没有财产观念。&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ctx.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">		<span class="string">&quot;totalScore&quot;</span>: totalScore,</span><br><span class="line">		<span class="string">&quot;result&quot;</span>:     result,</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>配置下路由</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">group.POST(<span class="string">&quot;&quot;</span>, router.api.HandleAnswers)</span><br></pre></td></tr></table></figure><p>简单测试能得到结果</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;result&quot;</span><span class="punctuation">:</span> <span class="string">&quot;散漫，爱玩，富于幻想。聪明机灵，待人热情，爱交朋友，但对朋友没有严格的选择标准。事业心较差，更善于享受生活，意志力和耐心都较差，我行我素。有较好的异性缘，但对爱情不够坚持认真，容易妥协。没有财产观念。&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;totalScore&quot;</span><span class="punctuation">:</span> <span class="number">32</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>此时 API 就完成了，接着就是部署</p><h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><p>如果按照其他语言，一般都是 <code>FROM</code> 一个官方的基础镜像，然后在上面再进行构建，这样就有第一种</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> <span class="keyword">FROM</span> golang:alpine</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>这样出来的镜像是很大的，因为 golang 的 alpine 镜像本身就很大了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">REPOSITORY           TAG       IMAGE ID       CREATED          SIZE</span><br><span class="line">golang               alpine    5dd973625d31   4 weeks ago      352MB</span><br></pre></td></tr></table></figure><p>而由于 go 本身特点，可以编译出来一个摆脱其他束缚的二进制文件，因此可以直接上 alpine</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> alpine</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> goquestionapi .</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8080</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [ <span class="string">&quot;/app/goquestionapi&quot;</span> ]</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build .</span><br><span class="line"></span><br><span class="line">docker build -t goquestionapi .</span><br></pre></td></tr></table></figure><p>这样 build 出来的程序有 13M，还可以再优化下，<code>-s</code> 可以去掉符号表，<code>-w</code> 可以去掉调试信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags=<span class="string">&quot;-w -s&quot;</span> .</span><br></pre></td></tr></table></figure><p>这样 build 出来的程序只有 8.5M</p><p>跑下镜像测试下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --<span class="built_in">rm</span> -p 8080:8080 -e DB_SOURCE=<span class="string">&quot;postgresql://postgres:postgres@192.168.31.60:5432/postgres?sslmode=disable&amp;search_path=question&quot;</span> -d goquestionapi</span><br></pre></td></tr></table></figure><p>访问正常拿到数据</p><p>此时 docker 镜像大小为 14.4M</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">REPOSITORY           TAG       IMAGE ID       CREATED          SIZE</span><br><span class="line">goquestionapi        latest    109360c6fafd   6 minutes ago    14.4MB</span><br></pre></td></tr></table></figure><p>上面说了，由于 go 自身的特性，如果没有额外的需求，还可以用 <code>scratch</code> 镜像，只是这样就不能 sh 进去容器，如果有访问外网的需求，也会报 SSL 证书错误，又或者时区的问题，因为里面确实什么都没有</p><p>这个 scratch 感觉更像是一个概念，不是实际可以摸到的东西，因为如果像其他镜像那样 pull 的话，会报错</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker pull scratch</span><br><span class="line"></span><br><span class="line">Using default tag: latest</span><br><span class="line">Error response from daemon: <span class="string">&#x27;scratch&#x27;</span> is a reserved name</span><br></pre></td></tr></table></figure><p>这样 build 出来的镜像大小就又小了些</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">REPOSITORY           TAG       IMAGE ID       CREATED          SIZE</span><br><span class="line">goquestionapi        latest    7ac80b2a1ad0   3 seconds ago    8.86MB</span><br></pre></td></tr></table></figure><p>但是为了后续方便 sh 进去，还是习惯用 alpine，也不差那几兆硬盘</p><p>现如今都在谈 DevOps，谈云原生，一般 cicd 都在云端了，因此会有第二种，分阶段构建</p><p>这个时候就需要一个 go 环境，所以要利用 golang 镜像来做编译，完了再把编译出来的程序，再复制到基础的 alpine 镜像上</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> golang:alpine AS builder</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags=<span class="string">&quot;-w -s&quot;</span> .</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> alpine</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=builder /app/goquestionapi .</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> app.env .</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8080</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [ <span class="string">&quot;/app/goquestionapi&quot;</span> ]</span></span><br></pre></td></tr></table></figure><p>此时编译正常，镜像小，也能正常运行</p><p><code>docker build</code> 的方式会产生很多 <code>&lt;none&gt;</code> 的没用的镜像，每次还要跑一大串命令，这有点不方便，因此可以用 <code>Docker Compose</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">goquestionapi:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">goquestionapi</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">goquestionapi</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8080</span><span class="string">:8080</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=Asia/Shanghai</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">GIN_MODE=release</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DB_SOURCE=postgresql://postgres:postgres@192.168.31.60:5432/postgres?sslmode=disable&amp;search_path=question</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">LOG_LEVEL=info</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br></pre></td></tr></table></figure><p>只要 <code>docker-compose build</code> 就可以把镜像 build 出来，并且可以灵活修改配置，命令不变，和 Makefile 的思想一样</p><p>还有一个好处就是没有 <code>&lt;none&gt;</code> 镜像，代码洁癖+强迫症患者表示很舒服</p><p>此时跑 <code>docker-compose up</code>，也能正常看到数据</p><p>以上是本地部署，线上大多是 Kubernetes 环境</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">goquestionapi</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">goquestionapi</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">goquestionapi</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">goquestionapi</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">goquestionapi</span></span><br><span class="line">          <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line">          <span class="attr">resources:</span></span><br><span class="line">            <span class="attr">limits:</span></span><br><span class="line">              <span class="attr">memory:</span> <span class="string">&quot;20Mi&quot;</span></span><br><span class="line">              <span class="attr">cpu:</span> <span class="string">&quot;500m&quot;</span></span><br><span class="line">          <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">8080</span></span><br><span class="line">          <span class="attr">env:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">GIN_MODE</span></span><br><span class="line">              <span class="attr">value:</span> <span class="string">release</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_SOURCE</span></span><br><span class="line">              <span class="attr">value:</span> <span class="string">postgresql://postgres:postgres@postgres-postgresql.default.svc.cluster.local:5432/postgres?sslmode=disable&amp;search_path=question</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">goquestionapi</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">goquestionapi</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">8080</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">goquestionapi</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">goquestionapi</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">nginx.ingress.kubernetes.io/rewrite-target:</span> <span class="string">/$2</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">http:</span></span><br><span class="line">        <span class="attr">paths:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">&quot;/api(/|$)(.*)&quot;</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">goquestionapi</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">8080</span></span><br></pre></td></tr></table></figure><p>由于我本地 K8s 环境是 <code>kind</code>，所以要把镜像 load 进去</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kind load docker-image goquestionapi</span><br></pre></td></tr></table></figure><p>有两点需要注意，第一就是确保能拿到镜像，要么给个 tag 不用 latest 再通过加载镜像的方式，要么修改 imagePullPolicy 为 IfNotPresent 或者 Never，要么正确配置仓库地址，无论用 Docker Hub 还是自建</p><p>还有一点就是 postgres 要用 K8s 内部的连接，因为我的 postgres 是用 helm 安装的，所以可以通过 <code>helm status postgres</code> 查看到集群内部链接</p><p>apply 后访问 <code>http://localhost/api/questions</code>，也能正常看到数据</p><p>VSCode 或者 Goland 装好 Kubernetes 插件后，都能很方便直接 apply</p><p>VSCode 的话，配置写在一起会有提示无法对比，只能对比单个的，但是单个的话，已经 apply 了的配置会自动带上时间之类的额外的东西，对比起来也不是很直接，所以这里还是写在一起</p><p>至此，API 部分完</p><h1 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h1><h2 id="前期准备-1"><a href="#前期准备-1" class="headerlink" title="前期准备"></a>前期准备</h2><p>利用 <code>create-react-app</code> 来创建 React 项目</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn create react-app reactquestionweb</span><br></pre></td></tr></table></figure><p>接着集成第三方组件，<code>axios</code> 刚发布了 <code>1.0.0</code> 版本，会有兼容问题，因此还是用回老版本 <code>0.27.2</code> 版本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yarn add antd</span><br><span class="line">yarn add axios@0.27.2</span><br><span class="line">yarn add use-axios-react</span><br></pre></td></tr></table></figure><h2 id="编写业务逻辑-1"><a href="#编写业务逻辑-1" class="headerlink" title="编写业务逻辑"></a>编写业务逻辑</h2><p>这里没什么好说的了，用函数式组件 + hook 完成网络请求、条件渲染，其他的就按照后端接口约定的参数提交</p><p>不会 CSS，所以没有太多华丽的辞藻显示在页面上</p><h2 id="部署-1"><a href="#部署-1" class="headerlink" title="部署"></a>部署</h2><p>部署好多人都喜欢用 node 的镜像然后用 npm start，但其实我这边习惯用 nginx，除了 <code>yarn build</code> 会有优化外，你都 build 出来静态文件了，还要 node 干啥</p><p>Dockerfile</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> node:alpine AS builder</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yarn &amp;&amp; yarn build</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> nginx:alpine</span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=builder /app/build /usr/share/nginx/html</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><p>compose.yaml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">reactquestionweb:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">reactquestionweb</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">reactquestionweb</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">3000</span><span class="string">:80</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br></pre></td></tr></table></figure><p>k8s.yaml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">reactquestionweb</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">reactquestionweb</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">reactquestionweb</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">reactquestionweb</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">reactquestionweb</span></span><br><span class="line">          <span class="attr">resources:</span></span><br><span class="line">            <span class="attr">limits:</span></span><br><span class="line">              <span class="attr">memory:</span> <span class="string">&quot;20Mi&quot;</span></span><br><span class="line">              <span class="attr">cpu:</span> <span class="string">&quot;500m&quot;</span></span><br><span class="line">          <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">reactquestionweb</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">reactquestionweb</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">80</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">reactquestionweb</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">reactquestionweb</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">http:</span></span><br><span class="line">        <span class="attr">paths:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">&quot;/&quot;</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">reactquestionweb</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><p>然后访问 <code>http://localhost</code>，一切正常</p><p>到这里就完了，附上项目地址</p><p><a target="_blank" rel="noopener" href="https://github.com/linweiyuan/goquestionapi">API</a></p><p><a target="_blank" rel="noopener" href="https://github.com/linweiyuan/reactquestionweb">WEB</a></p><hr><p>纯属抛砖玉玉，如果有不同的意见，以你的为准</p></div><div class="article-footer"><blockquote class="mt-2x"><ul class="post-copyright list-unstyled"><li class="post-copyright-link hidden-xs"><strong>本文链接：</strong> <a href="https://linweiyuan.github.io/2022/10/05/Go-React%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%9F%BA%E7%A1%80%E7%9A%84%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%97%AE%E5%8D%B7%E5%8A%9F%E8%83%BD.html" title="Go+React实现一个基础的前后端分离问卷功能" target="_blank" rel="external">https://linweiyuan.github.io/2022/10/05/Go-React实现一个基础的前后端分离问卷功能.html</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！</li></ul></blockquote></div></article><section id="comments"></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2022/10/15/%E8%87%AA%E5%AE%9A%E4%B9%89starter%E5%A4%84%E7%90%86%E5%BC%82%E5%B8%B8%E5%92%8C%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94%E6%97%A5%E5%BF%97.html" title="自定义starter处理异常和请求响应日志"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/2022/10/01/IntelliJ-IDEA-Conf-2022.html" title="IntelliJ IDEA Conf 2022"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li></ul><div class="bar-right"></div></div></nav></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/linweiyuan" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul><div class="copyright">&copy; 2023 林伟源<div class="publishby">Theme by <a href="https://github.com/cofess" target="_blank">cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.</div></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"分类",TAGS:"标签",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script></body></html>